!function(){"use strict";try{if("undefined"!=typeof document){var o=document.createElement("style");o.appendChild(document.createTextNode('._container_13zim_6{display:flex;grid-area:header;width:100%;height:5vh}._decentFacet_13zim_14{background-color:#000;width:8.5vh;clip-path:polygon(0 0,100% 0,calc(100% - 5vh) 100%,0% 100%);margin-right:-5vh}._appFacet_13zim_21{background:linear-gradient(#c57431,#222);clip-path:polygon(5vh 0,100% 0,calc(100% - 5vh) 100%,0% 100%);margin-right:-6.1vh;padding-right:6vh;display:inline-block;color:#fff;position:relative}._appName_13zim_31{padding-left:5.5vh;padding-right:7vh;font-size:4vh;-webkit-text-fill-color:white;-webkit-text-stroke-width:.2vh;-webkit-text-stroke-color:#222222;font-family:hobby-of-night;display:inline-block;overflow-x:visible;white-space:nowrap}._appButtonArea_13zim_44{display:inline-block;height:100%;margin-left:-4vh}._appFacetSeparator_13zim_50{background-color:#000;width:6vh;margin-right:-5.5vh;clip-path:polygon(5vh 0,100% 0,calc(100% - 5vh) 100%,0% 100%)}._contributorFacet_13zim_57{background:linear-gradient(#ddd,#222);flex:1;clip-path:polygon(5vh 0,100% 0,100% 100%,0% 100%);margin-right:-5vh;padding-left:5vh;position:relative;color:#555;font-size:1vh}._favIcon_13zim_68{position:relative;top:.5vh;left:.5vh;height:4vh}._settingsIcon_13zim_75{position:absolute;top:.5vh;right:6vh;height:4vh;width:4vh;cursor:pointer}._contentButton_rhsdb_6{justify-content:center;background-color:#c57431;border-style:none;background-position:center;transition:background .2s;cursor:pointer;margin-right:.1vh;margin-bottom:.1vh;padding-left:.2vh;padding-right:.2vh}._contentButton_rhsdb_6:hover{background:#e68a40 radial-gradient(circle,transparent 1%,#c57431 1%) center/23000%}._contentButton_rhsdb_6:active{background-color:#e68a40;background-size:100%;transition:background 0s}._contentButtonText_rhsdb_29{font-size:1.4vh;letter-spacing:.1vh;color:#fff}._contentButtonDisabled_rhsdb_35{background-color:gray;cursor:default}._contentButtonDisabled_rhsdb_35:hover{background:gray}._contentButtonTextDisabled_rhsdb_45{color:#d3d3d3}._fullscreenOverlay_nh884_4{position:fixed;width:100%;height:100%;inset:0;background-color:#000c;z-index:2}._clickable_nh884_16{cursor:pointer}._dialog_nh884_20{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:50%;background-color:#fff;border-style:solid;border-radius:1rem;border-width:.6rem;padding:2rem;font-size:1.5rem;cursor:default}._dialog_nh884_20>h1{text-align:center;margin-bottom:2rem;font-size:1.5rem;margin-top:0;width:100%;background-color:#ffe9d7;padding:.5rem}._bar_c4j8c_6{display:flex;justify-content:flex-start;align-items:stretch;flex-wrap:wrap}._label_c4j8c_13{flex-grow:0;min-width:7vh;padding-left:.5vh;padding-right:.5vh;font-size:1.3vh}._selectorButton_c4j8c_22{justify-content:center;background-color:#c57431;border-style:none solid none none;border-color:#aa6226;background-position:center;transition:background .2s;cursor:pointer;margin-bottom:.1vh}._tabButton_c4j8c_34{border-top-left-radius:.5vh;border-top-right-radius:.5vh;margin-bottom:0;margin-right:.1vh}._selectorButton_c4j8c_22:hover{background:#e68a40 radial-gradient(circle,transparent 1%,#c57431 1%) center/23000%}._selectorButton_c4j8c_22:active{background-color:#e68a40;background-size:100%;transition:background 0s}._firstSelectorButton_c4j8c_50{border-top-left-radius:.5vh;border-bottom-left-radius:.5vh}._lastSelectorButton_c4j8c_55{border-top-right-radius:.5vh;border-bottom-right-radius:.5vh}._selectorButtonText_c4j8c_60{padding-left:.5vh;padding-right:.5vh;letter-spacing:.1vh;font-size:1.1vh;color:#fff}._selectorButtonSelected_c4j8c_68{background-color:#e68a40;cursor:default}._icon_c4j8c_74{display:inline-block;height:1.1vh;font-size:1vh;padding-left:.3vh;color:#fff;cursor:default}._iconDisabled_c4j8c_83{cursor:pointer}._selectorButtonSelectedReclickable_c4j8c_88{background-color:#e68a40;cursor:pointer}._selectorButtonSelected_c4j8c_68:hover{background-color:#e68a40}._selectorButtonTextSelected_c4j8c_98{color:#fff}._selectorButtonDisabled_c4j8c_103{background-color:gray;cursor:pointer}._selectorButtonDisabled_c4j8c_103:hover,._selectorButtonDisabled_c4j8c_103:active{background-color:gray}._selectorButtonTextDisabled_c4j8c_116{color:#d3d3d3}._container_iv4ss_1{position:relative;display:inline-block}._contentBox_iv4ss_6{position:fixed;background-color:#faebd7;width:25vh;left:0;top:0;border-color:#000;border-width:.2vh;border-radius:1vh;border-style:solid;box-shadow:0 .5vh 1vh #0000001a;z-index:10}._container_1dxqw_4{height:50vh;border-color:#e68a40;border-style:solid;border-width:.2vh;border-image:linear-gradient(to bottom,#e68a40,#fdebd7) 1;background-color:#f9f9f8;overflow-x:hidden;overflow-y:hidden}._container_1dxqw_4>p{font-size:1.4vh;padding-top:1vh;padding-left:.5vh;padding-right:.5vh;margin-bottom:1vh;background:linear-gradient(to bottom,#e68a40,#f9f9f8 80% 100%)}._setterList_1dxqw_29{position:relative;overflow-y:auto;overflow-x:hidden;height:46vh;box-sizing:border-box}._setterList_1dxqw_29:hover{scrollbar-color:#c57431 white}._container_1vhj3_4{font-size:1vh;display:flex;margin-bottom:.5vh}._container_1vhj3_4>input{font-size:1vh}._label_1vhj3_14{margin-left:1vh;margin-right:1vh;min-width:15vw;display:inline-block;font-size:1vh}._labelDisabled_1vhj3_22{color:gray}._heading_1vhj3_27{padding-left:.5vh;margin-bottom:1vh;background:linear-gradient(to bottom,#ffe6c1,#f9f9f8)}._headingDisabled_1vhj3_37{color:gray;background:linear-gradient(to bottom,#e1e1e1,#f9f9f8)}._heading_1vhj3_27>p{font-size:1.1vh;font-weight:700;padding-top:.5vh;padding-bottom:0}._heading_1vhj3_27>hr{margin:0;border:none;height:.1vh;background-color:#e68a40}._validationMessage_1vhj3_61{margin-left:1vh;padding-top:.1vh;font-size:.8vh;color:red}._validationMessage_1vhj3_61:before{content:"⬅ "}._container_1vhj3_4 input:focus,button:focus{outline:none;border-color:#e68a40;box-shadow:0 0 .5vh #e68a40}._headingButton_1gpxc_6{justify-content:center;background-color:#c57431;border-style:none;background-position:center;transition:background .2s;cursor:pointer;margin-right:.3vh;margin-bottom:.1vh;padding-left:.3vh;padding-right:.3vh}._headingButton_1gpxc_6:hover{background:#e68a40 radial-gradient(circle,transparent 1%,#c57431 1%) center/23000%}._headingButton_1gpxc_6:active{background-color:#e68a40;background-size:100%;transition:background 0s}._headingButtonText_1gpxc_29{font-size:.9vh;letter-spacing:.1vh;color:#fff}._headingButtonDisabled_1gpxc_35{background-color:gray;cursor:default}._headingButtonDisabled_1gpxc_35:hover{background:gray}._headingButtonTextDisabled_1gpxc_45{color:#d3d3d3}._container_t15oa_1 p{padding:.5vh 1vh;font-size:1vh}._modelIdText_t15oa_9{padding-left:1vh;padding-right:1vh;padding-bottom:.2vh;background-color:#fff;border-top-left-radius:1vh;border-top-right-radius:1vh;text-align:center;font-size:1vh}._appBehaviorSummary_t15oa_20{padding-top:.5vh;padding-bottom:0;font-style:italic;font-size:1vh}._speedContainer_t15oa_27{width:100%;padding:.5vh;padding-top:0}._container_dabnx_1{display:inline-flex}._speedBox_dabnx_5{border:1px solid black;align-items:center;position:relative;overflow:hidden;font-size:1vh;color:#000;padding-left:.5vh;padding-right:.5vh}._progressBar_dabnx_16{position:absolute;bottom:0;left:0;height:100%;z-index:-1}._overTextBar_dabnx_24{position:absolute;bottom:0;right:0;height:100%;background-color:#ffffffe6;z-index:1;pointer-events:none}._inputSpeedBox_dabnx_34{background-color:#e6b489;border-right:0}._outputSpeedBox_dabnx_40{background-color:#fdc28d}._problemList_1a0tc_4{margin:.5vh 2vh}._problemList_1a0tc_4 li{display:flex;align-items:center;font-size:1vh;min-height:2vh;margin-bottom:.5vh;margin-right:.5vh}._icon_1a0tc_20{width:2vh;margin-right:.5vh}._container_1ldt5_1{width:100%;display:flex;justify-content:flex-end;margin-top:.5rem}._dialogButton_1e5oo_6{flex-basis:10vh;justify-content:center;background-color:#c57431;border-style:none;background-position:center;transition:background .2s;cursor:pointer;margin-right:.1vh;margin-bottom:.1vh}._dialogButton_1e5oo_6:hover{background:#e68a40 radial-gradient(circle,transparent 1%,#c57431 1%) center/23000%}._dialogButton_1e5oo_6:active{background-color:#e68a40;background-size:100%;transition:background 0s}._dialogButtonText_1e5oo_28{letter-spacing:.1vh;font-size:1.4vh;color:#fff}._dialogButtonDisabled_1e5oo_34{background-color:gray;cursor:default}._dialogButtonDisabled_1e5oo_34:hover{background:gray}._dialogButtonTextDisabled_1e5oo_44{color:#d3d3d3}._dialogButtonPrimary_1e5oo_49{background-color:#ff850b;border-style:solid;border-width:.1vh;border-color:#ba7840;box-sizing:border-box}._disableSelect_mpqe1_1{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._container_hyytp_4{width:100%;height:calc(100% - .3rem);position:fixed;left:0;top:0;margin-left:5rem;margin-right:5rem;display:flex;flex-direction:column-reverse;pointer-events:none;z-index:1000}._container_10gzw_3{background-color:gray;width:calc(100% - 12rem);border-radius:1rem;border-color:#b08859;border-style:solid;border-width:.1rem;margin-bottom:.1rem;cursor:pointer;padding-left:3rem;padding-right:3rem;display:table;pointer-events:all}._container_10gzw_3>p{font-size:1.5rem;text-align:center;vertical-align:middle;display:table-cell}._containerError_10gzw_26{background-color:#ff6060}._containerInfo_10gzw_31{background-color:#e9c5a7}._containerImportant_10gzw_36{background-color:#f6e3a1}@keyframes _appear_10gzw_1{0%{opacity:0}to{opacity:100%}}@keyframes _disappear_10gzw_1{0%{opacity:100%}to{opacity:0}}._containerAppear_10gzw_51{animation:_appear_10gzw_1 1s;animation-fill-mode:forwards}._containerDisappear_10gzw_56{animation:_disappear_10gzw_1 1s;animation-fill-mode:forwards}._dismissIcon_10gzw_61{float:right;margin-right:-2rem;margin-top:.5rem;margin-bottom:.5rem;font-size:1rem;color:#444;cursor:pointer}._continueText_rt9ep_4{margin-bottom:2vh}._modelIdText_rt9ep_8{font-size:1.5vh;background-color:#f9f9f8;border-radius:.5vh;padding:.2vh;white-space:nowrap}._problemPanel_rt9ep_16{padding:2vh}')),document.head.appendChild(o)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}}();
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","react-dom"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["decent-portal"]={},e.React,e.ReactDOM)}(this,function(e,t,n){"use strict";var r,a={exports:{}},o={};var i,s,l={};
/**
   * @license React
   * react-jsx-runtime.development.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */function c(){return i||(i=1,"production"!==process.env.NODE_ENV&&function(){function e(t){if(null==t)return null;if("function"==typeof t)return t.$$typeof===w?null:t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case h:return"Fragment";case M:return"Profiler";case _:return"StrictMode";case L:return"Suspense";case v:return"SuspenseList";case I:return"Activity"}if("object"==typeof t)switch("number"==typeof t.tag&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),t.$$typeof){case p:return"Portal";case b:return t.displayName||"Context";case g:return(t._context.displayName||"Context")+".Consumer";case C:var n=t.render;return(t=t.displayName)||(t=""!==(t=n.displayName||n.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case q:return null!==(n=t.displayName||null)?n:e(t.type)||"Memo";case y:n=t._payload,t=t._init;try{return e(t(n))}catch(r){}}return null}function n(e){return""+e}function r(e){try{n(e);var t=!1}catch(o){t=!0}if(t){var r=(t=console).error,a="function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return r.call(t,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",a),n(e)}}function a(t){if(t===h)return"<>";if("object"==typeof t&&null!==t&&t.$$typeof===y)return"<...>";try{var n=e(t);return n?"<"+n+">":"<...>"}catch(r){return"<...>"}}function o(){return Error("react-stack-top-frame")}function i(){var t=e(this.type);return E[t]||(E[t]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),void 0!==(t=this.props.ref)?t:null}function s(t,n,a,o,s,l){var d,m=n.children;if(void 0!==m)if(o)if(x(m)){for(o=0;o<m.length;o++)c(m[o]);Object.freeze&&Object.freeze(m)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else c(m);if(S.call(n,"key")){m=e(t);var p=Object.keys(n).filter(function(e){return"key"!==e});o=0<p.length?"{key: someKey, "+p.join(": ..., ")+": ...}":"{key: someKey}",N[m+o]||(p=0<p.length?"{"+p.join(": ..., ")+": ...}":"{}",console.error('A props object containing a "key" prop is being spread into JSX:\n  let props = %s;\n  <%s {...props} />\nReact keys must be passed directly to JSX without using spread:\n  let props = %s;\n  <%s key={someKey} {...props} />',o,m,p,m),N[m+o]=!0)}if(m=null,void 0!==a&&(r(a),m=""+a),function(e){if(S.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return!1}return void 0!==e.key}(n)&&(r(n.key),m=""+n.key),"key"in n)for(var h in a={},n)"key"!==h&&(a[h]=n[h]);else a=n;return m&&function(e,t){function n(){u||(u=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",t))}n.isReactWarning=!0,Object.defineProperty(e,"key",{get:n,configurable:!0})}(a,"function"==typeof t?t.displayName||t.name||"Unknown":t),function(e,t,n,r,a,o){var s=n.ref;return e={$$typeof:f,type:e,key:t,props:n,_owner:r},null!==(void 0!==s?s:null)?Object.defineProperty(e,"ref",{enumerable:!1,get:i}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(e,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:a}),Object.defineProperty(e,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:o}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}(t,m,a,null===(d=B.A)?null:d.getOwner(),s,l)}function c(e){d(e)?e._store&&(e._store.validated=1):"object"==typeof e&&null!==e&&e.$$typeof===y&&("fulfilled"===e._payload.status?d(e._payload.value)&&e._payload.value._store&&(e._payload.value._store.validated=1):e._store&&(e._store.validated=1))}function d(e){return"object"==typeof e&&null!==e&&e.$$typeof===f}var u,m=t,f=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),g=Symbol.for("react.consumer"),b=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),q=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),w=Symbol.for("react.client.reference"),B=m.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,S=Object.prototype.hasOwnProperty,x=Array.isArray,R=console.createTask?console.createTask:function(){return null},E={},T=(m={react_stack_bottom_frame:function(e){return e()}}).react_stack_bottom_frame.bind(m,o)(),j=R(a(o)),N={};l.Fragment=h,l.jsx=function(e,t,n){var r=1e4>B.recentlyCreatedOwnerStacks++;return s(e,t,n,!1,r?Error("react-stack-top-frame"):T,r?R(a(e)):j)},l.jsxs=function(e,t,n){var r=1e4>B.recentlyCreatedOwnerStacks++;return s(e,t,n,!0,r?Error("react-stack-top-frame"):T,r?R(a(e)):j)}}()),l}var d=(s||(s=1,"production"===process.env.NODE_ENV?a.exports=function(){if(r)return o;r=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(t,n,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==n.key&&(a=""+n.key),"key"in n)for(var o in r={},n)"key"!==o&&(r[o]=n[o]);else r=n;return n=r.ref,{$$typeof:e,type:t,key:a,ref:void 0!==n?n:null,props:r}}return o.Fragment=t,o.jsx=n,o.jsxs=n,o}():a.exports=c()),a.exports);const u="_container_13zim_6 _disableSelect_mpqe1_1",m="_decentFacet_13zim_14",f="_appFacet_13zim_21",p="_appName_13zim_31",h="_appButtonArea_13zim_44",_="_appFacetSeparator_13zim_50",M="_contributorFacet_13zim_57",g="_favIcon_13zim_68",b="_settingsIcon_13zim_75",C="_contentButton_rhsdb_6 _disableSelect_mpqe1_1",L="_contentButtonText_rhsdb_29",v="_contentButtonDisabled_rhsdb_35 _contentButton_rhsdb_6 _disableSelect_mpqe1_1",q="_contentButtonTextDisabled_rhsdb_45 _contentButtonText_rhsdb_29";function y(e){const{text:t,onClick:n,disabled:r}=e,a=r?v:C,o=r?q:L;return d.jsx("button",{className:a,onClick:n,disabled:r,children:d.jsx("span",{className:o,children:t})})}function I(){return window.location.pathname}function w(e,t="Value is unexpectedly undefined/null."){if(null==e)throw new Error(t)}function B(e,t="Assertion failed."){if(!e)throw new Error(t)}function S(e="Botched!"){throw new Error(e)}let x=null;function R(e=""){e.startsWith("http"),e.startsWith("/")&&(e=e.slice(1));const t=(x||(x=function(e){const t=e.split("/").filter(e=>""!==e);if(t.length<1)return"/";const n=t[0];return n.startsWith("_")&&t.length>1?`/${n}/${t[1]}/`:`/${n}/`}(I())),x);return`${t}${e}`}const E="_fullscreenOverlay_nh884_4",T="_clickable_nh884_16",j="_dialog_nh884_20";function N(e){e.stopPropagation()}function k(e){if(!e.isOpen)return null;const{children:t,onCancel:n,title:r}=e,a=`${E} ${n?T:""}`;return d.jsx("div",{className:a,onMouseDown:n,children:d.jsxs("div",{className:j,onClick:N,onMouseDown:N,children:[d.jsx("h1",{children:r}),t]})})}const A="HEADING";function P(e){return{...e,buttons:e.buttons?[...e.buttons]:void 0}}const D="DecentPortal-1",O="KeyValue",V="pathIndex",$={__version:1,[O]:{__options:{keyPath:"key"},__indexes:[{name:V,keypath:"path",options:{unique:!1,multiEntry:!1}}]}};function Q(e,t){const n=function(e){return Object.keys(e).filter(e=>"__version"!==e)}(t);n.forEach(n=>{const r=t[n],a=e.createObjectStore(n,r.__options);(r.__indexes??[]).forEach(e=>{a.createIndex(e.name,e.keypath,e.options)})})}async function H(e,t){const n=t.__version;return new Promise((r,a)=>{const o=indexedDB.open(e,n);o.onerror=t=>a(`Failed to open "${e}" database with error code ${t.target.errorCode}.`),o.onupgradeneeded=e=>{const n=e.target.result;if(1!==t.__version)throw new Error("Schema migration is unimplemented.");Q(n,t)},o.onsuccess=e=>{const t=e.target.result;t.onerror=e=>{throw Error("Database error: "+e.target.errorCode)},r(t)}})}async function G(e,t,n){const r=e.transaction(t,"readwrite");return r.objectStore(t).put(n),new Promise((e,n)=>{r.onerror=e=>n(`Failed to put to "${t} with error code ${e.target.errorCode}.`),r.oncomplete=()=>e()})}async function F(e){const t=await H(D,$),n=await async function(e,t,n){const r=e.transaction(t),a=r.objectStore(t).get(n);return new Promise((e,n)=>{r.onerror=e=>n(`Failed to get from "${t} with error code ${e.target.errorCode}.`),r.oncomplete=t=>e(a.result)})}(t,O,e);if(!n)return null;if(1===n.appDataVersion)return n;if(n.appDataVersion>1)throw new Error(`Record at ${e} is v${n.appDataVersion} while app only knows versions up to v1.`);return function(e){if(1!==e.appDataVersion)throw new Error(`Record at ${e.key} did not have upgrade handling.`)}(n),G(t,O,n),n}async function U(e){const t=await F(e);return t?.text??null}async function z(e,t,n="text/plain"){await async function(e,t,n,r){const a=await H(D,$),o=await F(e)??{key:e};o[t]=n,o.path=function(e){const t=e.lastIndexOf("/")+1;return e.substring(0,t)}(e),o.appDataVersion=1,o.mimeType=r,o.lastModified=Date.now(),await G(a,O,o)}(e,"text",t,n)}async function Y(e){const t=await H(D,$);await async function(e,t,n){const r=e.transaction(t,"readwrite");return r.objectStore(t).delete(n),new Promise((e,a)=>{r.onerror=e=>a(`Failed to delete record at "${n}" in "${t} with error code ${e.target.errorCode}.`),r.oncomplete=()=>e()})}(t,O,e)}function W(e){return`/settings/${e}.json`}async function J(e){const t=W(e),n=await U(t);if(!n)return null;const r=JSON.parse(n);return(a=r)&&"object"==typeof a&&!Array.isArray(a)&&Object.keys(a).every(e=>"string"==typeof e&&("number"==typeof a[e]||"string"==typeof a[e]||"boolean"==typeof a[e]))?Object.keys(r).length>0?r:null:(console.error(`Settings for category "${e}" are invalid.`),null);var a}async function Z(e,t){const n=W(e),r=JSON.stringify(t);await z(n,r)}function X(e){return!(!e||"object"!=typeof e)&&("string"==typeof e.id&&("string"==typeof e.appBehaviorSummary&&(void 0===e.beta||"boolean"==typeof e.beta)))}function K(e){return{...e}}var ee=(e=>(e[e.BOOLEAN_TOGGLE=1]="BOOLEAN_TOGGLE",e[e.NUMERIC=2]="NUMERIC",e[e.SUPPORTED_MODEL=3]="SUPPORTED_MODEL",e[e.TEXT=0]="TEXT",e))(ee||{});function te(e){switch(e.type){case ee.BOOLEAN_TOGGLE:case ee.NUMERIC:return function(e){return{...e}}(e);case ee.SUPPORTED_MODEL:return function(e){return{...e,models:e.models.map(K)}}(e);case ee.TEXT:return function(e){return{...e}}(e)}}function ne(e){return{...e}}function re(e,t){const n=function(e){return{name:e.name,id:e.id,description:e.description,headings:e.headings?e.headings.map(P):void 0,settings:e.settings.map(te),disablementRules:e.disablementRules?e.disablementRules.map(ne):void 0}}(e);return n.settings=function(e,t){const n=e.map(te);return Object.keys(t).forEach(e=>{const r=function(e,t){for(let n=0;n<e.length;n++)if(e[n].id===t)return n;return-1}(n,e);-1!==r&&(n[r].value=t[e])}),n}(n.settings,t),n}function ae(e){const t={};return e.forEach(e=>{e.id&&(t[e.id]=e.value)}),t}function oe(e){if("mini"===e.toLowerCase())return!0;const t=e[e.length-1];if(-1==="BbMm".indexOf(t)||e.length<2)return!1;for(let n=0;n<e.length-1;++n){const t=e[n];if(-1==="0123456789.".indexOf(t))return!1}return!0}function ie(e){return"distill"===e.toLowerCase()}function se(e){return function(e){const t=e.toLowerCase(),n=e.toUpperCase();return e!==t&&e!==n}(e)?e:function(e){return e.length,e[0].toUpperCase()+e.slice(1).toLowerCase()}(e)}function le(e){return"mini"===e.toLowerCase()?"Mini":e.toUpperCase()}function ce(e){return{series:[],seriesMax:e,lastAverage:0}}function de(e,t){const{series:n,seriesMax:r}=t;n.push(e),n.length>r&&n.shift();const a=n.reduce((e,t)=>e+t,0);return t.lastAverage=a/n.length,t.lastAverage}var ue=(e=>(e[e.INSUFFICIENT_VRAM=0]="INSUFFICIENT_VRAM",e[e.INSUFFICIENT_STORAGE=1]="INSUFFICIENT_STORAGE",e[e.BAD_LOAD_SUCCESS_HISTORY=2]="BAD_LOAD_SUCCESS_HISTORY",e[e.BAD_PERFORMANCE_HISTORY=3]="BAD_PERFORMANCE_HISTORY",e[e.DEVELOPER_MODE=4]="DEVELOPER_MODE",e[e.WEBGPU_NOT_AVAILABLE=5]="WEBGPU_NOT_AVAILABLE",e[e.BETA=6]="BETA",e))(ue||{});async function me(){if(!(globalThis.navigator&&globalThis.navigator.gpu&&globalThis.navigator.storage&&globalThis.navigator.storage.estimate))return 0;const e=await navigator.storage.estimate();if(!e||void 0===e.quota||void 0===e.usage)return 0;return e.quota-e.usage}function fe(e){return e&&Array.isArray(e.series)&&"number"==typeof e.seriesMax&&"number"==typeof e.lastAverage&&e.series.every(e=>"number"==typeof e)}function pe(e){return`/deviceHistory/models/${e}.json`}function he(){return{loadSuccessRate:ce(4),loadTime:ce(4),inputCharsPerSec:ce(20),outputCharsPerSec:ce(20)}}async function _e(e){const t=pe(e),n=await U(t);if(!n)return he();try{const t=JSON.parse(n);return(r=t)&&fe(r.loadSuccessRate)&&fe(r.loadTime)&&fe(r.inputCharsPerSec)&&fe(r.outputCharsPerSec)?t:(console.error(`Model device history for model ${e} is not in the expected format. Reinitializing history.`),he())}catch(a){return console.error(`Failed to parse model device history for model ${e}:`,a),he()}var r}const Me={"Llama-3.2-1B-Instruct-q4f32_1-MLC":{modelId:"Llama-3.2-1B-Instruct-q4f32_1-MLC",vramRequiredMb:1128.82},"Llama-3.2-1B-Instruct-q4f16_1-MLC":{modelId:"Llama-3.2-1B-Instruct-q4f16_1-MLC",vramRequiredMb:879.04},"Llama-3.2-1B-Instruct-q0f32-MLC":{modelId:"Llama-3.2-1B-Instruct-q0f32-MLC",vramRequiredMb:5106.26},"Llama-3.2-1B-Instruct-q0f16-MLC":{modelId:"Llama-3.2-1B-Instruct-q0f16-MLC",vramRequiredMb:2573.13},"Llama-3.2-3B-Instruct-q4f32_1-MLC":{modelId:"Llama-3.2-3B-Instruct-q4f32_1-MLC",vramRequiredMb:2951.51},"Llama-3.2-3B-Instruct-q4f16_1-MLC":{modelId:"Llama-3.2-3B-Instruct-q4f16_1-MLC",vramRequiredMb:2263.69},"Llama-3.1-8B-Instruct-q4f32_1-MLC-1k":{modelId:"Llama-3.1-8B-Instruct-q4f32_1-MLC-1k",vramRequiredMb:5295.7},"Llama-3.1-8B-Instruct-q4f16_1-MLC-1k":{modelId:"Llama-3.1-8B-Instruct-q4f16_1-MLC-1k",vramRequiredMb:4598.34},"Llama-3.1-8B-Instruct-q4f32_1-MLC":{modelId:"Llama-3.1-8B-Instruct-q4f32_1-MLC",vramRequiredMb:6101.01},"Llama-3.1-8B-Instruct-q4f16_1-MLC":{modelId:"Llama-3.1-8B-Instruct-q4f16_1-MLC",vramRequiredMb:5001},"DeepSeek-R1-Distill-Qwen-1.5B-q4f16_1-MLC":{modelId:"DeepSeek-R1-Distill-Qwen-1.5B-q4f16_1-MLC",vramRequiredMb:1629.75},"DeepSeek-R1-Distill-Qwen-1.5B-q4f32_1-MLC":{modelId:"DeepSeek-R1-Distill-Qwen-1.5B-q4f32_1-MLC",vramRequiredMb:1888.97},"DeepSeek-R1-Distill-Qwen-7B-q4f16_1-MLC":{modelId:"DeepSeek-R1-Distill-Qwen-7B-q4f16_1-MLC",vramRequiredMb:5106.67},"DeepSeek-R1-Distill-Qwen-7B-q4f32_1-MLC":{modelId:"DeepSeek-R1-Distill-Qwen-7B-q4f32_1-MLC",vramRequiredMb:5900.09},"DeepSeek-R1-Distill-Llama-8B-q4f32_1-MLC":{modelId:"DeepSeek-R1-Distill-Llama-8B-q4f32_1-MLC",vramRequiredMb:6101.01},"DeepSeek-R1-Distill-Llama-8B-q4f16_1-MLC":{modelId:"DeepSeek-R1-Distill-Llama-8B-q4f16_1-MLC",vramRequiredMb:5001},"Hermes-2-Theta-Llama-3-8B-q4f16_1-MLC":{modelId:"Hermes-2-Theta-Llama-3-8B-q4f16_1-MLC",vramRequiredMb:4976.13},"Hermes-2-Theta-Llama-3-8B-q4f32_1-MLC":{modelId:"Hermes-2-Theta-Llama-3-8B-q4f32_1-MLC",vramRequiredMb:6051.27},"Hermes-2-Pro-Llama-3-8B-q4f16_1-MLC":{modelId:"Hermes-2-Pro-Llama-3-8B-q4f16_1-MLC",vramRequiredMb:4976.13},"Hermes-2-Pro-Llama-3-8B-q4f32_1-MLC":{modelId:"Hermes-2-Pro-Llama-3-8B-q4f32_1-MLC",vramRequiredMb:6051.27},"Hermes-3-Llama-3.2-3B-q4f32_1-MLC":{modelId:"Hermes-3-Llama-3.2-3B-q4f32_1-MLC",vramRequiredMb:2951.51},"Hermes-3-Llama-3.2-3B-q4f16_1-MLC":{modelId:"Hermes-3-Llama-3.2-3B-q4f16_1-MLC",vramRequiredMb:2263.69},"Hermes-3-Llama-3.1-8B-q4f32_1-MLC":{modelId:"Hermes-3-Llama-3.1-8B-q4f32_1-MLC",vramRequiredMb:5779.27},"Hermes-3-Llama-3.1-8B-q4f16_1-MLC":{modelId:"Hermes-3-Llama-3.1-8B-q4f16_1-MLC",vramRequiredMb:4876.13},"Hermes-2-Pro-Mistral-7B-q4f16_1-MLC":{modelId:"Hermes-2-Pro-Mistral-7B-q4f16_1-MLC",vramRequiredMb:4033.28},"Phi-3.5-mini-instruct-q4f16_1-MLC":{modelId:"Phi-3.5-mini-instruct-q4f16_1-MLC",vramRequiredMb:3672.07},"Phi-3.5-mini-instruct-q4f32_1-MLC":{modelId:"Phi-3.5-mini-instruct-q4f32_1-MLC",vramRequiredMb:5483.12},"Phi-3.5-mini-instruct-q4f16_1-MLC-1k":{modelId:"Phi-3.5-mini-instruct-q4f16_1-MLC-1k",vramRequiredMb:2520.07},"Phi-3.5-mini-instruct-q4f32_1-MLC-1k":{modelId:"Phi-3.5-mini-instruct-q4f32_1-MLC-1k",vramRequiredMb:3179.12},"Phi-3.5-vision-instruct-q4f16_1-MLC":{modelId:"Phi-3.5-vision-instruct-q4f16_1-MLC",vramRequiredMb:3952.18},"Phi-3.5-vision-instruct-q4f32_1-MLC":{modelId:"Phi-3.5-vision-instruct-q4f32_1-MLC",vramRequiredMb:5879.84},"Mistral-7B-Instruct-v0.3-q4f16_1-MLC":{modelId:"Mistral-7B-Instruct-v0.3-q4f16_1-MLC",vramRequiredMb:4573.39},"Mistral-7B-Instruct-v0.3-q4f32_1-MLC":{modelId:"Mistral-7B-Instruct-v0.3-q4f32_1-MLC",vramRequiredMb:5619.27},"Mistral-7B-Instruct-v0.2-q4f16_1-MLC":{modelId:"Mistral-7B-Instruct-v0.2-q4f16_1-MLC",vramRequiredMb:4573.39},"OpenHermes-2.5-Mistral-7B-q4f16_1-MLC":{modelId:"OpenHermes-2.5-Mistral-7B-q4f16_1-MLC",vramRequiredMb:4573.39},"NeuralHermes-2.5-Mistral-7B-q4f16_1-MLC":{modelId:"NeuralHermes-2.5-Mistral-7B-q4f16_1-MLC",vramRequiredMb:4573.39},"WizardMath-7B-V1.1-q4f16_1-MLC":{modelId:"WizardMath-7B-V1.1-q4f16_1-MLC",vramRequiredMb:4573.39},"SmolLM2-1.7B-Instruct-q4f16_1-MLC":{modelId:"SmolLM2-1.7B-Instruct-q4f16_1-MLC",vramRequiredMb:1774.19},"SmolLM2-1.7B-Instruct-q4f32_1-MLC":{modelId:"SmolLM2-1.7B-Instruct-q4f32_1-MLC",vramRequiredMb:2692.38},"SmolLM2-360M-Instruct-q0f16-MLC":{modelId:"SmolLM2-360M-Instruct-q0f16-MLC",vramRequiredMb:871.99},"SmolLM2-360M-Instruct-q0f32-MLC":{modelId:"SmolLM2-360M-Instruct-q0f32-MLC",vramRequiredMb:1743.99},"SmolLM2-360M-Instruct-q4f16_1-MLC":{modelId:"SmolLM2-360M-Instruct-q4f16_1-MLC",vramRequiredMb:376.06},"SmolLM2-360M-Instruct-q4f32_1-MLC":{modelId:"SmolLM2-360M-Instruct-q4f32_1-MLC",vramRequiredMb:579.61},"SmolLM2-135M-Instruct-q0f16-MLC":{modelId:"SmolLM2-135M-Instruct-q0f16-MLC",vramRequiredMb:359.69},"SmolLM2-135M-Instruct-q0f32-MLC":{modelId:"SmolLM2-135M-Instruct-q0f32-MLC",vramRequiredMb:719.38},"gemma-2-2b-it-q4f16_1-MLC":{modelId:"gemma-2-2b-it-q4f16_1-MLC",vramRequiredMb:1895.3},"gemma-2-2b-it-q4f32_1-MLC":{modelId:"gemma-2-2b-it-q4f32_1-MLC",vramRequiredMb:2508.75},"gemma-2-2b-it-q4f16_1-MLC-1k":{modelId:"gemma-2-2b-it-q4f16_1-MLC-1k",vramRequiredMb:1583.3},"gemma-2-2b-it-q4f32_1-MLC-1k":{modelId:"gemma-2-2b-it-q4f32_1-MLC-1k",vramRequiredMb:1884.75},"gemma-2-9b-it-q4f16_1-MLC":{modelId:"gemma-2-9b-it-q4f16_1-MLC",vramRequiredMb:6422.01},"gemma-2-9b-it-q4f32_1-MLC":{modelId:"gemma-2-9b-it-q4f32_1-MLC",vramRequiredMb:8383.33},"gemma-2-2b-jpn-it-q4f16_1-MLC":{modelId:"gemma-2-2b-jpn-it-q4f16_1-MLC",vramRequiredMb:1895.3},"gemma-2-2b-jpn-it-q4f32_1-MLC":{modelId:"gemma-2-2b-jpn-it-q4f32_1-MLC",vramRequiredMb:2508.75},"Qwen3-0.6B-q4f16_1-MLC":{modelId:"Qwen3-0.6B-q4f16_1-MLC",vramRequiredMb:1403.34},"Qwen3-0.6B-q4f32_1-MLC":{modelId:"Qwen3-0.6B-q4f32_1-MLC",vramRequiredMb:1924.98},"Qwen3-0.6B-q0f16-MLC":{modelId:"Qwen3-0.6B-q0f16-MLC",vramRequiredMb:2220.38},"Qwen3-0.6B-q0f32-MLC":{modelId:"Qwen3-0.6B-q0f32-MLC",vramRequiredMb:3843.25},"Qwen3-1.7B-q4f16_1-MLC":{modelId:"Qwen3-1.7B-q4f16_1-MLC",vramRequiredMb:2036.66},"Qwen3-1.7B-q4f32_1-MLC":{modelId:"Qwen3-1.7B-q4f32_1-MLC",vramRequiredMb:2635.44},"Qwen3-4B-q4f16_1-MLC":{modelId:"Qwen3-4B-q4f16_1-MLC",vramRequiredMb:3431.59},"Qwen3-4B-q4f32_1-MLC":{modelId:"Qwen3-4B-q4f32_1-MLC",vramRequiredMb:4327.71},"Qwen3-8B-q4f16_1-MLC":{modelId:"Qwen3-8B-q4f16_1-MLC",vramRequiredMb:5695.78},"Qwen3-8B-q4f32_1-MLC":{modelId:"Qwen3-8B-q4f32_1-MLC",vramRequiredMb:6852.55},"Qwen2.5-0.5B-Instruct-q4f16_1-MLC":{modelId:"Qwen2.5-0.5B-Instruct-q4f16_1-MLC",vramRequiredMb:944.62},"Qwen2.5-0.5B-Instruct-q4f32_1-MLC":{modelId:"Qwen2.5-0.5B-Instruct-q4f32_1-MLC",vramRequiredMb:1060.2},"Qwen2.5-0.5B-Instruct-q0f16-MLC":{modelId:"Qwen2.5-0.5B-Instruct-q0f16-MLC",vramRequiredMb:1624.12},"Qwen2.5-0.5B-Instruct-q0f32-MLC":{modelId:"Qwen2.5-0.5B-Instruct-q0f32-MLC",vramRequiredMb:2654.75},"Qwen2.5-1.5B-Instruct-q4f16_1-MLC":{modelId:"Qwen2.5-1.5B-Instruct-q4f16_1-MLC",vramRequiredMb:1629.75},"Qwen2.5-1.5B-Instruct-q4f32_1-MLC":{modelId:"Qwen2.5-1.5B-Instruct-q4f32_1-MLC",vramRequiredMb:1888.97},"Qwen2.5-3B-Instruct-q4f16_1-MLC":{modelId:"Qwen2.5-3B-Instruct-q4f16_1-MLC",vramRequiredMb:2504.76},"Qwen2.5-3B-Instruct-q4f32_1-MLC":{modelId:"Qwen2.5-3B-Instruct-q4f32_1-MLC",vramRequiredMb:2893.64},"Qwen2.5-7B-Instruct-q4f16_1-MLC":{modelId:"Qwen2.5-7B-Instruct-q4f16_1-MLC",vramRequiredMb:5106.67},"Qwen2.5-7B-Instruct-q4f32_1-MLC":{modelId:"Qwen2.5-7B-Instruct-q4f32_1-MLC",vramRequiredMb:5900.09},"Qwen2.5-Coder-0.5B-Instruct-q4f16_1-MLC":{modelId:"Qwen2.5-Coder-0.5B-Instruct-q4f16_1-MLC",vramRequiredMb:944.62},"Qwen2.5-Coder-0.5B-Instruct-q4f32_1-MLC":{modelId:"Qwen2.5-Coder-0.5B-Instruct-q4f32_1-MLC",vramRequiredMb:1060.2},"Qwen2.5-Coder-0.5B-Instruct-q0f16-MLC":{modelId:"Qwen2.5-Coder-0.5B-Instruct-q0f16-MLC",vramRequiredMb:1624.12},"Qwen2.5-Coder-0.5B-Instruct-q0f32-MLC":{modelId:"Qwen2.5-Coder-0.5B-Instruct-q0f32-MLC",vramRequiredMb:2654.75},"Qwen2.5-Coder-1.5B-Instruct-q4f16_1-MLC":{modelId:"Qwen2.5-Coder-1.5B-Instruct-q4f16_1-MLC",vramRequiredMb:1629.75},"Qwen2.5-Coder-1.5B-Instruct-q4f32_1-MLC":{modelId:"Qwen2.5-Coder-1.5B-Instruct-q4f32_1-MLC",vramRequiredMb:1888.97},"Qwen2.5-Coder-3B-Instruct-q4f16_1-MLC":{modelId:"Qwen2.5-Coder-3B-Instruct-q4f16_1-MLC",vramRequiredMb:2504.76},"Qwen2.5-Coder-3B-Instruct-q4f32_1-MLC":{modelId:"Qwen2.5-Coder-3B-Instruct-q4f32_1-MLC",vramRequiredMb:2893.64},"Qwen2.5-Coder-7B-Instruct-q4f16_1-MLC":{modelId:"Qwen2.5-Coder-7B-Instruct-q4f16_1-MLC",vramRequiredMb:5106.67},"Qwen2.5-Coder-7B-Instruct-q4f32_1-MLC":{modelId:"Qwen2.5-Coder-7B-Instruct-q4f32_1-MLC",vramRequiredMb:5900.09},"Qwen2.5-Math-1.5B-Instruct-q4f16_1-MLC":{modelId:"Qwen2.5-Math-1.5B-Instruct-q4f16_1-MLC",vramRequiredMb:1629.75},"Qwen2.5-Math-1.5B-Instruct-q4f32_1-MLC":{modelId:"Qwen2.5-Math-1.5B-Instruct-q4f32_1-MLC",vramRequiredMb:1888.97},"stablelm-2-zephyr-1_6b-q4f16_1-MLC":{modelId:"stablelm-2-zephyr-1_6b-q4f16_1-MLC",vramRequiredMb:2087.66},"stablelm-2-zephyr-1_6b-q4f32_1-MLC":{modelId:"stablelm-2-zephyr-1_6b-q4f32_1-MLC",vramRequiredMb:2999.33},"stablelm-2-zephyr-1_6b-q4f16_1-MLC-1k":{modelId:"stablelm-2-zephyr-1_6b-q4f16_1-MLC-1k",vramRequiredMb:1511.66},"stablelm-2-zephyr-1_6b-q4f32_1-MLC-1k":{modelId:"stablelm-2-zephyr-1_6b-q4f32_1-MLC-1k",vramRequiredMb:1847.33},"RedPajama-INCITE-Chat-3B-v1-q4f16_1-MLC":{modelId:"RedPajama-INCITE-Chat-3B-v1-q4f16_1-MLC",vramRequiredMb:2972.09},"RedPajama-INCITE-Chat-3B-v1-q4f32_1-MLC":{modelId:"RedPajama-INCITE-Chat-3B-v1-q4f32_1-MLC",vramRequiredMb:3928.09},"RedPajama-INCITE-Chat-3B-v1-q4f16_1-MLC-1k":{modelId:"RedPajama-INCITE-Chat-3B-v1-q4f16_1-MLC-1k",vramRequiredMb:2041.09},"RedPajama-INCITE-Chat-3B-v1-q4f32_1-MLC-1k":{modelId:"RedPajama-INCITE-Chat-3B-v1-q4f32_1-MLC-1k",vramRequiredMb:2558.09},"TinyLlama-1.1B-Chat-v1.0-q4f16_1-MLC":{modelId:"TinyLlama-1.1B-Chat-v1.0-q4f16_1-MLC",vramRequiredMb:697.24},"TinyLlama-1.1B-Chat-v1.0-q4f32_1-MLC":{modelId:"TinyLlama-1.1B-Chat-v1.0-q4f32_1-MLC",vramRequiredMb:839.98},"TinyLlama-1.1B-Chat-v1.0-q4f16_1-MLC-1k":{modelId:"TinyLlama-1.1B-Chat-v1.0-q4f16_1-MLC-1k",vramRequiredMb:675.24},"TinyLlama-1.1B-Chat-v1.0-q4f32_1-MLC-1k":{modelId:"TinyLlama-1.1B-Chat-v1.0-q4f32_1-MLC-1k",vramRequiredMb:795.98},"Llama-3.1-70B-Instruct-q3f16_1-MLC":{modelId:"Llama-3.1-70B-Instruct-q3f16_1-MLC",vramRequiredMb:31153.13},"Qwen2-0.5B-Instruct-q4f16_1-MLC":{modelId:"Qwen2-0.5B-Instruct-q4f16_1-MLC",vramRequiredMb:944.62},"Qwen2-0.5B-Instruct-q0f16-MLC":{modelId:"Qwen2-0.5B-Instruct-q0f16-MLC",vramRequiredMb:1624.12},"Qwen2-0.5B-Instruct-q0f32-MLC":{modelId:"Qwen2-0.5B-Instruct-q0f32-MLC",vramRequiredMb:2654.75},"Qwen2-1.5B-Instruct-q4f16_1-MLC":{modelId:"Qwen2-1.5B-Instruct-q4f16_1-MLC",vramRequiredMb:1629.75},"Qwen2-1.5B-Instruct-q4f32_1-MLC":{modelId:"Qwen2-1.5B-Instruct-q4f32_1-MLC",vramRequiredMb:1888.97},"Qwen2-7B-Instruct-q4f16_1-MLC":{modelId:"Qwen2-7B-Instruct-q4f16_1-MLC",vramRequiredMb:5106.67},"Qwen2-7B-Instruct-q4f32_1-MLC":{modelId:"Qwen2-7B-Instruct-q4f32_1-MLC",vramRequiredMb:5900.09},"Qwen2-Math-1.5B-Instruct-q4f16_1-MLC":{modelId:"Qwen2-Math-1.5B-Instruct-q4f16_1-MLC",vramRequiredMb:1629.75},"Qwen2-Math-1.5B-Instruct-q4f32_1-MLC":{modelId:"Qwen2-Math-1.5B-Instruct-q4f32_1-MLC",vramRequiredMb:1888.97},"Qwen2-Math-7B-Instruct-q4f16_1-MLC":{modelId:"Qwen2-Math-7B-Instruct-q4f16_1-MLC",vramRequiredMb:5106.67},"Qwen2-Math-7B-Instruct-q4f32_1-MLC":{modelId:"Qwen2-Math-7B-Instruct-q4f32_1-MLC",vramRequiredMb:5900.09},"Llama-3-8B-Instruct-q4f32_1-MLC-1k":{modelId:"Llama-3-8B-Instruct-q4f32_1-MLC-1k",vramRequiredMb:5295.7},"Llama-3-8B-Instruct-q4f16_1-MLC-1k":{modelId:"Llama-3-8B-Instruct-q4f16_1-MLC-1k",vramRequiredMb:4598.34},"Llama-3-8B-Instruct-q4f32_1-MLC":{modelId:"Llama-3-8B-Instruct-q4f32_1-MLC",vramRequiredMb:6101.01},"Llama-3-8B-Instruct-q4f16_1-MLC":{modelId:"Llama-3-8B-Instruct-q4f16_1-MLC",vramRequiredMb:5001},"Llama-3-70B-Instruct-q3f16_1-MLC":{modelId:"Llama-3-70B-Instruct-q3f16_1-MLC",vramRequiredMb:31153.13},"Phi-3-mini-4k-instruct-q4f16_1-MLC":{modelId:"Phi-3-mini-4k-instruct-q4f16_1-MLC",vramRequiredMb:3672.07},"Phi-3-mini-4k-instruct-q4f32_1-MLC":{modelId:"Phi-3-mini-4k-instruct-q4f32_1-MLC",vramRequiredMb:5483.12},"Phi-3-mini-4k-instruct-q4f16_1-MLC-1k":{modelId:"Phi-3-mini-4k-instruct-q4f16_1-MLC-1k",vramRequiredMb:2520.07},"Phi-3-mini-4k-instruct-q4f32_1-MLC-1k":{modelId:"Phi-3-mini-4k-instruct-q4f32_1-MLC-1k",vramRequiredMb:3179.12},"Llama-2-7b-chat-hf-q4f32_1-MLC-1k":{modelId:"Llama-2-7b-chat-hf-q4f32_1-MLC-1k",vramRequiredMb:5284.01},"Llama-2-7b-chat-hf-q4f16_1-MLC-1k":{modelId:"Llama-2-7b-chat-hf-q4f16_1-MLC-1k",vramRequiredMb:4618.52},"Llama-2-7b-chat-hf-q4f32_1-MLC":{modelId:"Llama-2-7b-chat-hf-q4f32_1-MLC",vramRequiredMb:9109.03},"Llama-2-7b-chat-hf-q4f16_1-MLC":{modelId:"Llama-2-7b-chat-hf-q4f16_1-MLC",vramRequiredMb:6749.02},"Llama-2-13b-chat-hf-q4f16_1-MLC":{modelId:"Llama-2-13b-chat-hf-q4f16_1-MLC",vramRequiredMb:11814.09},"gemma-2b-it-q4f16_1-MLC":{modelId:"gemma-2b-it-q4f16_1-MLC",vramRequiredMb:1476.52},"gemma-2b-it-q4f32_1-MLC":{modelId:"gemma-2b-it-q4f32_1-MLC",vramRequiredMb:1750.66},"gemma-2b-it-q4f16_1-MLC-1k":{modelId:"gemma-2b-it-q4f16_1-MLC-1k",vramRequiredMb:1476.52},"gemma-2b-it-q4f32_1-MLC-1k":{modelId:"gemma-2b-it-q4f32_1-MLC-1k",vramRequiredMb:1750.66},"phi-2-q4f16_1-MLC":{modelId:"phi-2-q4f16_1-MLC",vramRequiredMb:3053.97},"phi-2-q4f32_1-MLC":{modelId:"phi-2-q4f32_1-MLC",vramRequiredMb:4032.48},"phi-2-q4f16_1-MLC-1k":{modelId:"phi-2-q4f16_1-MLC-1k",vramRequiredMb:2131.97},"phi-2-q4f32_1-MLC-1k":{modelId:"phi-2-q4f32_1-MLC-1k",vramRequiredMb:2740.48},"phi-1_5-q4f16_1-MLC":{modelId:"phi-1_5-q4f16_1-MLC",vramRequiredMb:1210.09},"phi-1_5-q4f32_1-MLC":{modelId:"phi-1_5-q4f32_1-MLC",vramRequiredMb:1682.09},"phi-1_5-q4f16_1-MLC-1k":{modelId:"phi-1_5-q4f16_1-MLC-1k",vramRequiredMb:1210.09},"phi-1_5-q4f32_1-MLC-1k":{modelId:"phi-1_5-q4f32_1-MLC-1k",vramRequiredMb:1682.09},"TinyLlama-1.1B-Chat-v0.4-q4f16_1-MLC":{modelId:"TinyLlama-1.1B-Chat-v0.4-q4f16_1-MLC",vramRequiredMb:697.24},"TinyLlama-1.1B-Chat-v0.4-q4f32_1-MLC":{modelId:"TinyLlama-1.1B-Chat-v0.4-q4f32_1-MLC",vramRequiredMb:839.98},"TinyLlama-1.1B-Chat-v0.4-q4f16_1-MLC-1k":{modelId:"TinyLlama-1.1B-Chat-v0.4-q4f16_1-MLC-1k",vramRequiredMb:675.24},"TinyLlama-1.1B-Chat-v0.4-q4f32_1-MLC-1k":{modelId:"TinyLlama-1.1B-Chat-v0.4-q4f32_1-MLC-1k",vramRequiredMb:795.98},"snowflake-arctic-embed-m-q0f32-MLC-b32":{modelId:"snowflake-arctic-embed-m-q0f32-MLC-b32",vramRequiredMb:1407.51},"snowflake-arctic-embed-m-q0f32-MLC-b4":{modelId:"snowflake-arctic-embed-m-q0f32-MLC-b4",vramRequiredMb:539.4},"snowflake-arctic-embed-s-q0f32-MLC-b32":{modelId:"snowflake-arctic-embed-s-q0f32-MLC-b32",vramRequiredMb:1022.82},"snowflake-arctic-embed-s-q0f32-MLC-b4":{modelId:"snowflake-arctic-embed-s-q0f32-MLC-b4",vramRequiredMb:238.71}},ge=1073741824;const be="llm",Ce="llmMaxSize",Le="autoIncMaxSize";function ve(){const e=globalThis.navigator&&"deviceMemory"in navigator?navigator.deviceMemory:"memory"in performance?Math.floor(performance.memory.jsHeapSizeLimit/ge):0,t=Math.round(e/ge);return Math.max(8,t)}async function qe(){const e=await J(be)??{};return re({name:"LLM",id:be,description:"Settings for loading and using LLMs (Large Language Models) on this device.",settings:[{type:ee.NUMERIC,id:Ce,label:"Max LLM size (GB)",value:ve(),minValue:1,maxValue:256},{type:ee.BOOLEAN_TOGGLE,id:Le,label:"Auto-increase max LLM",value:!0}],headings:[{precedeSettingId:"llmMaxSize",description:"The max LLM size prevents attempting to load models that are unlikely to succeed and could cause system instability. The auto-increment option will increase the max LLM size if evidence is found during loading to support a larger size."}]},e)}let ye=null;function Ie(){if(!ye)throw new Error("App metadata not initialized yet.");return ye.name}async function we(){if(ye)return;let e,t="";try{t=await async function(){const e=R("app-metadata.json"),t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch app metadata from ${e}: ${t.status} ${t.statusText}`);return await t.text()}()}catch(r){throw console.error("Could not fetch app-metadata.json from server. Add this file to your /public or web-serving directory to fix."),new Error("Failed to fetch app metadata: "+r)}try{e=JSON.parse(t)}catch(r){throw console.error("Server returned invalid JSON for app-metadata.json, which probably indicates a missing file. Add this file to your /public or web-serving directory to fix."),new Error("Failed to parse app metadata JSON: "+r)}if(!((n=e)&&"object"==typeof n&&"string"==typeof n.id&&"string"==typeof n.name&&"string"==typeof n.description&&Array.isArray(n.supportedModels)&&n.supportedModels.every(X)))throw new Error("Invalid app metadata format in app-metadata.json.");var n;ye=e}async function Be(){return ye||await we(),ye}let Se=null;function xe(e){const t=Me[e];return t&&t.vramRequiredMb?function(e,t=1){return Math.round(e/1024*Math.pow(10,t))/Math.pow(10,t)}(t.vramRequiredMb):0}async function Re(e){if(Se?.modelId===e)return;const t=await _e(e),n=xe(e);if(!n)throw new Error(`Model ${e} not found or has no required memory.`);Se={modelId:e,history:t,requiredMemoryGb:n,requiredStorageGb:3*n}}async function Ee(){await async function(e,t){const n=pe(e),r=JSON.stringify(t);await z(n,r)}(Se.modelId,Se.history)}function Te(e){const t=e.series.length,n=e.series.filter(e=>0===e).length;if(t===n)return 1===t?"Your last attempt to load this model failed.":t<e.seriesMax?`All ${t} of your attempts to load this model failed.`:`All of the last ${t} attempts to load this model failed.`;const r=t-n;return 0===e.series[e.series.length-1]?`This model loaded successfully ${r} in ${t} tries, with the last attempt failing.`:`This model loaded successfully ${r} in ${t} tries.`}function je(e,t){const n=e.lastAverage.toFixed(1),r=t.lastAverage.toFixed(1);return`This model's performance might be too slow. ${e.series.length?`Predicted input token rate is ${n} tokens/sec.`:"Can't predict input token rate."} ${t.series.length?`Predicted output token rate is ${r} tokens/sec.`:"Can't predict output token rate."}`}function Ne(e,t,n){if(0===n)return e?"Couldn't determine how much storage is available on the device. But you had previous success loading this model.":"Couldn't determine how much storage is available on the device. There might not be enough to load the model.";const r=(t-n).toFixed(1);return e?`Although you were successful loading this model previously, you might need an additional ${r} GB of free storage space on this device to load it safely.`:`You probably need an additional ${r} GB of free storage space on this device to load this model safely.`}function ke(e,t,n){return 0==n?e?"Couldn't determine how much memory is available on the device. But you did have previous success loading this model.":"Couldn't determine how much memory is available on the device. There might not be enough to load the model.":e?"It looks like you may not have enough video memory. But you did have previous success loading this model.":`You need ${t.toFixed(1)} GB of video memory to load this model. It seems unlikely to load, but you can try it.`}async function Ae(e){await Re(e);const t=[];globalThis.navigator&&globalThis.navigator.gpu&&globalThis.navigator.gpu||t.push({type:ue.WEBGPU_NOT_AVAILABLE,description:"Your browser doesn't support WebGPU. GPU-accelerated models won't load successfully. You could try using a different browser like Google Chrome or Microsoft Edge.",isBlocking:!0});const{loadSuccessRate:n}=Se.history;n.series.length&&n.lastAverage<1&&t.push({type:ue.BAD_LOAD_SUCCESS_HISTORY,description:Te(n),isBlocking:!1});const{inputCharsPerSec:r,outputCharsPerSec:a}=Se.history;var o,i;i=a,((o=r).series.length>0&&o.lastAverage<6||i.series.length>0&&i.lastAverage<3)&&t.push({type:ue.BAD_PERFORMANCE_HISTORY,description:je(r,a),isBlocking:!1});const s=await async function(){const e=await J(be);if(!e)return ve();return e[Ce]||ve()}(),l=n.series.some(e=>e>0);Se.requiredMemoryGb>s&&t.push({type:ue.INSUFFICIENT_VRAM,description:ke(l,Se.requiredMemoryGb,s),isBlocking:!1});const c=await me();return Se.requiredStorageGb>await me()&&t.push({type:ue.INSUFFICIENT_STORAGE,description:Ne(l,Se.requiredStorageGb,c),isBlocking:!1}),function(){const e=window.location.hostname;return"localhost"===e||function(e){return null!==e.match(/^\d+\.\d+\.\d+\.\d+$/g)}(e)}()&&t.push({type:ue.DEVELOPER_MODE,description:"You are running this web app from a local server, probably for development.",isBlocking:!1}),t.length?t:null}async function Pe(e,t){let n=await Ae(e)??[];Se.modelId,n=n.filter(e=>e.type!==ue.DEVELOPER_MODE);const r=Se.history.loadSuccessRate.series.length;if(!n.length&&!t)return r?(Se.history.loadSuccessRate.lastAverage,1===r?60:r<3?75:100):50;if(n.some(e=>e.isBlocking))return 0;let a=40;return a-=r?Math.round(10*(1-Se.history.loadSuccessRate.lastAverage)):5,n.some(e=>e.type===ue.INSUFFICIENT_VRAM)&&(a-=10),n.some(e=>e.type===ue.INSUFFICIENT_STORAGE)&&(a-=5),n.some(e=>e.type===ue.BAD_PERFORMANCE_HISTORY)&&(a-=5),t&&(a-=5),a}const De="auto-select",Oe={id:De,originalIndex:-1,displayName:"Auto Select",problems:null,inputCharsPerSec:0,outputCharsPerSec:0,appBehaviorSummary:"Automatically select the best model for your device and this app.",beta:!1,iconChar:null};async function Ve(e,t){const n=[],r=e.map((e,t)=>{const{id:r,beta:a,appBehaviorSummary:o}=e;let i=function(e,t=[]){let n="",r="",a="";const o=e.split("-");n=se(o[0].trim());for(let l=1;l<o.length;++l){const e=o[l].trim();oe(e)&&(r=le(e)),ie(e)&&l<o.length-1&&(a=se(o[l+1].trim()))}let i=a.length?`${a} < ${n} ${r}`.trim():`${n} ${r}`.trim();const s=t.filter(e=>e===i||e.startsWith(`${i} #`)).length;return s>0&&(i+=` #${s+1}`),i}(r,n);return n.push(i),{id:r,originalIndex:t,displayName:i,problems:null,inputCharsPerSec:0,outputCharsPerSec:0,beta:!!a,iconChar:null,appBehaviorSummary:o}}),a=r.sort((e,t)=>e.beta&&!t.beta?1:!e.beta&&t.beta?-1:e.originalIndex-t.originalIndex);a.unshift(Oe),t(r);const o=[...a];for(let i=1;i<o.length;++i){const e=o[i];e.problems=await Ae(e.id)??[],e.problems.length&&(e.problems=e.problems.filter(e=>e.type!==ue.DEVELOPER_MODE)),e.beta&&e.problems.push({type:ue.BETA,description:"Beta status: app has not been fully tested with this model.",isBlocking:!1}),e.problems.length||(e.problems=null),e.iconChar=e.problems?"⚠":null;const t=await _e(e.id);t.inputCharsPerSec.series.length&&(e.inputCharsPerSec=t.inputCharsPerSec.lastAverage),t.outputCharsPerSec.series.length&&(e.outputCharsPerSec=t.outputCharsPerSec.lastAverage)}t(o)}const $e="app-",Qe="llm";function He(e){const t=I().split("/").filter(e=>e.length);return t.length?`${$e}${t[0]}`:`${$e}${e}`}async function Ge(e,t){const n=[...e.settings];await async function(e){if(e.some(e=>e.id===Qe))return;const t=await Be();e.unshift({id:Qe,type:ee.SUPPORTED_MODEL,label:"LLM to use",value:De,models:t.supportedModels})}(n);const r=e.headings?[...e.headings]:[];return function(e){e.some(e=>e.precedeSettingId===Qe)||e.unshift({id:"LLM",description:"LLM Settings Specific to This App",precedeSettingId:Qe})}(r),{name:"This App",id:He(t),description:e.description,headings:r,settings:n,disablementRules:e.disablementRules}}async function Fe(){const{id:e}=await Be(),t=He(e);return await J(t)}var Ue=(e=>(e.INFO="info",e.IMPORTANT="important",e.ERROR="error",e))(Ue||{}),ze=(e=>(e[e.APPEARING=0]="APPEARING",e[e.VISIBLE=1]="VISIBLE",e[e.DISAPPEARING=2]="DISAPPEARING",e[e.GONE=3]="GONE",e))(ze||{});const Ye=new class{_subscriptions;constructor(){this._subscriptions=[]}sendToast(e,t){const n={message:e,type:t};this._subscriptions.forEach(e=>e(n))}subscribe(e){this._subscriptions.includes(e)||this._subscriptions.push(e)}unsubscribe(e){const t=this._subscriptions.indexOf(e);-1!==t&&this._subscriptions.splice(t,1)}};function We(e){Ye.sendToast(e,Ue.INFO)}function Je(e){Ye.sendToast(e,Ue.ERROR)}function Ze(e){return e===Ue.ERROR||e===Ue.IMPORTANT}function Xe(){return Date.now()}function Ke(e){const t=new Date(e);return t.getFullYear().toString().padStart(4,"0")+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")}function et(e){return`/log/${e}.txt`}function tt(e){if(!e.startsWith("/log/")||!e.endsWith(".txt"))throw Error(`Invalid log key: ${e}`);return e.slice(5,-4)}async function nt(e){const t=et(e);return await U(t)}async function rt(e,t){const n=et(e);await z(n,t)}async function at(e){const t=et(e);await Y(t)}async function ot(){return(await async function(e){const t=(await H(D,$)).transaction(O).objectStore(O).index(V).getAllKeys(e);return new Promise((n,r)=>{t.onerror=t=>r(`Failed to get all keys from "${e}" path with error code ${t.target.errorCode}.`),t.onsuccess=()=>n(t.result)})}("/log/")).map(tt).sort((e,t)=>e.localeCompare(t))}const it="UNINITIALIZED_DAY_PATH";let st=[],lt=it,ct=it,dt=0,ut=null,mt="",ft=null;function pt(){return ft&&ft[yt]||0}async function ht(){st.length;try{if(dt){const e=st.slice(0,dt);st=st.slice(dt),await rt(ct,e.join("\n")),dt=0,ct=it}await rt(lt,st.join("\n"))}catch(e){console.error("Unexpected error writing log buffer:",e)}}async function _t(e,t=!1){if("undefined"!=typeof self&&"DedicatedWorkerGlobalScope"===self.constructor.name)throw Error("Unexpected - log() should not be called in worker thread.");if(!ft)return void console.warn("Logging settings have not been applied yet. Failed to log:",e);if(!ft[qt])return;const n=Xe(),r=Ke(n);lt===it&&await async function(e){const t=await nt(e);t&&(st=t.split("\n")),lt=e}(r),lt!==r&&(dt=st.length,ct=lt,lt=r);const a=new Date(n).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});st.push(`[${a}] ${e}`),t?await ht():(ut&&clearTimeout(ut),ut=setTimeout(async()=>{await ht(),ut=null},3e3))}function Mt(e){return Ke(Xe()-864e5*e)}async function gt(e=1/0){const t=await async function(e){let t=await ot();if(!t.length)return"";if(e!==1/0){const n=Mt(e);t=t.filter(e=>e>n)}let n="";for(let r=0;r<t.length;++r){const e=t[r],a=await nt(e);a?(n+=`--- ${e} ---\n`,n+=a):console.error("Non-fatal error - no log text stored for ${dayPath} despite key being present.")}return n}(e);return!!t.length&&(self.navigator.clipboard.writeText(t),!0)}async function bt(e){ft=e;pt()>0&&await async function(){const e=Mt(pt()),t=(await ot()).filter(t=>t<=e).map(at);return await Promise.all(t)}()}var Ct=(e=>(e.COPY_ALL_LOGS="copyAllLogs",e.COPY_TODAY_LOGS="copyTodayLogs",e.CLEAR_LOGS="clearLogs",e))(Ct||{});async function Lt(e){switch(e){case"copyAllLogs":try{await gt()?We("All logs copied to clipboard. You can paste them into an email, issue, etc."):We("No logs found.")}catch(t){console.error(t),Je("Could not copy logs to the clipboard.")}break;case"copyTodayLogs":try{await gt(1)?We("Todays logs copied to clipboard. You can paste them into an email, issue, etc."):We("No logs found for today.")}catch(t){console.error(t),Je("Could not copy logs to the clipboard.")}break;case"clearLogs":try{await async function(){const e=(await ot()).map(at);return await Promise.all(e)}(),We("Logs cleared.")}catch(t){console.error(t),Je("Could not copy logs to the clipboard.")}}}const vt="logging",qt="enableLogging",yt="maxRetentionDays";function It(){return{name:"Logging",id:vt,description:"Settings for locally logging application events and errors. Logs are never sent to a server.",settings:[{type:ee.BOOLEAN_TOGGLE,id:qt,label:"Logging enabled?",value:!0},{type:ee.NUMERIC,id:yt,label:"Max days to keep",value:7,minValue:1,maxValue:1e3,allowDecimals:!1}],headings:[{precedeSettingId:null,description:"Logs can be useful for troubleshooting problems with apps. You can copy them from this dialog and paste into emails, Github issues, etc.",buttons:[{label:"Copy All Logs",value:Ct.COPY_ALL_LOGS},{label:"Copy Logs from Today",value:Ct.COPY_TODAY_LOGS},{label:"Clear Logs",value:Ct.CLEAR_LOGS}],onButtonClick:e=>Lt(e)}],disablementRules:[{targetSettingId:yt,criteriaSettingId:qt,criteriaValue:!1}]}}let wt=null,Bt=null;function St(e){Bt=e}function xt(e){if(e.length,!Bt)return 0;const t=function(e,t){return t.startsWith($e)?0:e.findIndex(e=>e.id===t)}(e,Bt);return t}function Rt(e=$e){if(!wt)throw Error("Call openSettingsDialog() only after the DecentBar component has been rendered.");St(e),wt(kn.name)}async function Et(e,t){const n=await async function(e,t){const{id:n}=await Be(),r=await Ge(e,n);let a=await Fe()??ae(r.settings);if(t){const e=t(a);e&&(a=e)}return re(r,a)}(e,t);return[n,await qe(),await async function(){const e=await J(vt)??{};return re(It(),e)}()]}async function Tt(e,t){const{id:n}=await Be(),r=He(n),a=e.map(e=>{let n=ae(e.settings);switch(e.id){case r:if(t){const e=t(n);e&&(n={...n,...e})}break;case vt:bt(n);break;case be:!async function(){Promise.resolve()}()}return Z(e.id,n)});try{await Promise.all(a)}catch(o){throw console.error("Error saving settings:",o),new Error("Failed to save settings. Please try again later.")}}const jt={bar:"_bar_c4j8c_6",label:"_label_c4j8c_13 _disableSelect_mpqe1_1",selectorButton:"_selectorButton_c4j8c_22 _disableSelect_mpqe1_1",tabButton:"_tabButton_c4j8c_34",firstSelectorButton:"_firstSelectorButton_c4j8c_50",lastSelectorButton:"_lastSelectorButton_c4j8c_55",selectorButtonText:"_selectorButtonText_c4j8c_60",selectorButtonSelected:"_selectorButtonSelected_c4j8c_68 _selectorButton_c4j8c_22 _disableSelect_mpqe1_1",icon:"_icon_c4j8c_74",iconDisabled:"_iconDisabled_c4j8c_83 _icon_c4j8c_74",selectorButtonSelectedReclickable:"_selectorButtonSelectedReclickable_c4j8c_88 _selectorButton_c4j8c_22 _disableSelect_mpqe1_1",selectorButtonTextSelected:"_selectorButtonTextSelected_c4j8c_98 _selectorButtonText_c4j8c_60",selectorButtonDisabled:"_selectorButtonDisabled_c4j8c_103 _selectorButton_c4j8c_22 _disableSelect_mpqe1_1",selectorButtonTextDisabled:"_selectorButtonTextDisabled_c4j8c_116 _selectorButtonText_c4j8c_60"},Nt={container:"_container_iv4ss_1",contentBox:"_contentBox_iv4ss_6"};var kt=(e=>(e[e.ABOVE=0]="ABOVE",e[e.BELOW=1]="BELOW",e[e.RIGHT=2]="RIGHT",e[e.LEFT=3]="LEFT",e))(kt||{});const At=[kt.ABOVE,kt.BELOW,kt.RIGHT,kt.LEFT];function Pt(e){return{left:e.left,top:e.top,width:e.width,height:e.height}}const Dt=[];function Ot(e,t){return e.left<=t.left&&e.top<=t.top&&e.left+e.width>=t.left+t.width&&e.top+e.height>=t.top+t.height}function Vt(e,t,n){const r=Pt(t.getBoundingClientRect()),a=Pt(n.getBoundingClientRect()),o=Pt(document.documentElement.getBoundingClientRect()),i={...a};let s=0,l=0,c=0,d=0,u=0;for(;u<e.length;++u){const t=e[u];if([s,l]=Dt[t](r,a),0===u&&(c=s,d=l),i.left=a.left+s,i.top=a.top+l,Ot(o,i))break}if(u===e.length){i.left=a.left+c,i.top=a.top+d;const e=function(e,t){const n={...t};return t.left<e.left?n.left=e.left:t.left+t.width>e.left+e.width&&(n.left=e.left+e.width-t.width),t.top<e.top?n.top=e.top:t.top+t.height>e.top+e.height&&(n.top=e.top+e.height-t.height),n}(o,i);s=e.left-a.left,l=e.top-a.top}return{transform:`translate(${s}px, ${l}px)`}}Dt[kt.ABOVE]=function(e,t){let n=e.left+Math.round((e.width-t.width)/2),r=e.top-t.height;return[n-t.left,r-t.top]},Dt[kt.BELOW]=function(e,t){let n=e.left+Math.round((e.width-t.width)/2),r=e.top+e.height;return[n-t.left,r-t.top]},Dt[kt.LEFT]=function(e,t){let n=e.left-t.width,r=e.top+Math.round((e.height-t.height)/2);return[n-t.left,r-t.top]},Dt[kt.RIGHT]=function(e,t){let n=e.left+e.width,r=e.top+Math.round((e.height-t.height)/2);return[n-t.left,r-t.top]};const $t={visibility:"hidden"};function Qt({children:e,content:r,preferredDirection:a,allowedDirections:o}){const[i,s]=t.useState(!1),[l,c]=t.useState([]),[u,m]=t.useState({}),f=t.useRef(null),p=t.useRef(null);t.useEffect(()=>{const e=function(e,t){void 0===e&&(e=At),void 0===t||t.length,Array.isArray(e)||(e=[e]);const n=[];return e.forEach(e=>{n.includes(e)||t&&!t.includes(e)||n.push(e)}),At.forEach(e=>{n.includes(e)||t&&!t.includes(e)||n.push(e)}),n.length,n}(a,o);c(e)},[]);const h=i?u:$t;function _(e){if(!f.current||!p.current||!i)return;const t=e.relatedTarget,n=p.current.contains(t);f.current.contains(t)||n||s(!1)}const M=n.createPortal(d.jsx("div",{className:Nt.contentBox,style:h,ref:p,onMouseOut:_,children:r}),document.body);return d.jsxs("div",{className:Nt.container,ref:f,children:[d.jsx("div",{onMouseOver:function(e){if(!f.current||!p.current||i)return;const t=e.relatedTarget;if(t&&f.current.contains(t))return;const n=Vt(l,f.current,p.current);m(n),s(!0)},onMouseOut:_,children:e}),M]})}function Ht({disabled:e,label:t,optionNames:n,onClick:r,onChange:a,selectedOptionNo:o,displayAsTabs:i,popoverContent:s,popoverPreferredDirection:l,popoverAllowedDirections:c,iconChars:u}){const m=e?jt.iconDisabled:jt.icon,f=n.map((t,f)=>{const p=void 0!==r?jt.selectorButtonSelectedReclickable:jt.selectorButtonSelected,h=f===o;let _=e?jt.selectorButtonDisabled:h?p:jt.selectorButton;const M=e?jt.selectorButtonTextDisabled:h?jt.selectorButtonTextSelected:jt.selectorButtonText;i?_=`${_} ${jt.tabButton}`:(0===f&&(_=`${_} ${jt.firstSelectorButton}`),f===n.length-1&&(_=`${_} ${jt.lastSelectorButton}`));const g=u&&u[f]?d.jsx("span",{className:m,children:u[f]}):null,b=d.jsxs("button",{className:_,onClick:()=>function(t){e||(r&&r(t),t!==o&&a&&a(t))}(f),disabled:e,children:[g,d.jsx("span",{className:M,children:t})]},t);return s?d.jsx(Qt,{content:s[f],preferredDirection:l,allowedDirections:c,children:b},t):b}),p=t?d.jsxs("span",{className:jt.label,children:[t,":"]}):null;return d.jsxs("div",{className:jt.bar,children:[p,f]})}function Gt({categoryNames:e,selectedCategoryNo:t,onChange:n,disabled:r}){return d.jsx(Ht,{optionNames:e,selectedOptionNo:t,onChange:n,disabled:r,displayAsTabs:!0})}const Ft={container:"_container_1dxqw_4",setterList:"_setterList_1dxqw_29"},Ut={container:"_container_1vhj3_4",label:"_label_1vhj3_14",labelDisabled:"_labelDisabled_1vhj3_22 _label_1vhj3_14",heading:"_heading_1vhj3_27",headingDisabled:"_headingDisabled_1vhj3_37 _heading_1vhj3_27",validationMessage:"_validationMessage_1vhj3_61"},zt="LAST_VALID_VALUE";let Yt=3e3;const Wt=new Map;function Jt(e){const t=Wt.get(e);t&&(clearTimeout(t),Wt.delete(e))}function Zt(e,t,n,r){if(!r)return n(null),!0;const a=r(e.id,e.value);return a?(Jt(e.id),n(a.failReason??null),void 0!==a.nextValue&&(e.value=a.nextValue===zt?t:a.nextValue,a.failReason&&function(e,t){Jt(e);const n=setTimeout(()=>{t(null),Wt.delete(e)},Yt);Wt.set(e,n)}(e.id,n),!0)):(n(null),!0)}function Xt({setting:e,onChange:n,onValidateSetting:r,disabled:a}){const[o,i]=t.useState(e.value),[s,l]=t.useState(null);const c=s?d.jsx("div",{className:Ut.validationMessage,children:s}):null,u=[e.falseLabel??"No",e.trueLabel??"Yes"],m=a?Ut.labelDisabled:Ut.label;return d.jsxs("div",{className:Ut.container,children:[d.jsx("span",{className:m,children:e.label}),d.jsx(Ht,{optionNames:u,selectedOptionNo:e.value?1:0,onChange:t=>function(t){const a={...e,value:t},s=Zt(a,o,l,r);s&&i(a.value),n(a,s)}(1===t),disabled:a}),c]})}function Kt(e){if(0===e)return 1;let t=Math.floor(Math.log10(Math.abs(e)))+1;return e<0&&t++,t}function en({minValue:e,maxValue:n,value:r,onChange:a,className:o,allowDecimals:i,digitWidth:s,disabled:l}){const[c,u]=t.useState(r.toString()),[m,f]=t.useState({});function p(t){try{let r=Number(t);return isNaN(r)&&(t=function(e){return e.replace(/[^0-9.-]/g,"")}(t)),r=Number(t),i||(r=Math.round(r)),r<e||isNaN(r)?e:r>n?n:r}catch(r){return e}}return t.useEffect(()=>{u(r.toString())},[r]),t.useEffect(()=>{const t=function(e,t,n,r){let a=r??Math.max(Kt(e),Kt(t));return n&&(a+=2),a?{width:`calc(${a}ch + 1vh)`}:{}}(e,n,i,s);f(t)},[s,e,n,i]),d.jsx("input",{type:"text",value:c,style:m,className:o,onChange:e=>function(e){u(e);const t=p(e);""+t===e&&a(t)}(e.target.value),onBlur:e=>function(e){const t=p(e);""+t!==e&&u(t.toString()),a(t)}(e.target.value),disabled:l})}function tn({setting:e,onChange:n,onValidateSetting:r,disabled:a}){const[o,i]=t.useState(e.value),[s,l]=t.useState(null);const c=s?d.jsx("div",{className:Ut.validationMessage,children:s}):null,u=a?Ut.labelDisabled:Ut.label;return d.jsxs("div",{className:Ut.container,children:[d.jsx("span",{className:u,children:e.label}),d.jsx(en,{minValue:e.minValue,maxValue:e.maxValue,allowDecimals:e.allowDecimals,value:e.value,onChange:function(t){const a={...e,value:t},s=Zt(a,o,l,r);s&&i(a.value),n(a,s)},disabled:a}),c]})}function nn({setting:e,onChange:n,onValidateSetting:r,disabled:a}){const[o,i]=t.useState(null),[s,l]=t.useState(e.value);const c=o?d.jsx("div",{className:Ut.validationMessage,children:o}):null,u=a?Ut.labelDisabled:Ut.label;return d.jsxs("div",{className:Ut.container,children:[d.jsx("span",{className:u,children:e.label}),d.jsx("input",{id:e.id,type:"text",value:e.value,onChange:t=>function(t){const a={...e,value:t},o=Zt(a,s,i,r);o&&l(a.value),n(a,o)}(t.target.value),placeholder:e.placeholder,disabled:a}),c]})}const rn={headingButton:"_headingButton_1gpxc_6 _disableSelect_mpqe1_1",headingButtonText:"_headingButtonText_1gpxc_29",headingButtonDisabled:"_headingButtonDisabled_1gpxc_35 _headingButton_1gpxc_6 _disableSelect_mpqe1_1",headingButtonTextDisabled:"_headingButtonTextDisabled_1gpxc_45 _headingButtonText_1gpxc_29"};function an({text:e,onClick:t,disabled:n}){const r=n?rn.headingButtonDisabled:rn.headingButton,a=n?rn.headingButtonTextDisabled:rn.headingButtonText;return d.jsx("button",{className:r,onClick:t,disabled:n,children:d.jsx("span",{className:a,children:e})})}function on(e,t){return e.buttons?e.buttons.map(n=>d.jsx(an,{text:n.label,onClick:()=>e.onButtonClick?.(n.value),disabled:t},n.value)):null}function sn({heading:e,disabled:t}){const n=e.buttons?d.jsx("div",{className:Ut.buttonsContainer,children:on(e,t)}):null,r=t?Ut.headingDisabled:Ut.heading;return d.jsxs("div",{className:r,children:[d.jsx("p",{children:e.description}),n]})}const ln={container:"_container_t15oa_1",modelIdText:"_modelIdText_t15oa_9",appBehaviorSummary:"_appBehaviorSummary_t15oa_20",speedContainer:"_speedContainer_t15oa_27"},cn={container:"_container_dabnx_1",progressBar:"_progressBar_dabnx_16",overTextBar:"_overTextBar_dabnx_24",inputSpeedBox:"_inputSpeedBox_dabnx_34 _speedBox_dabnx_5",outputSpeedBox:"_outputSpeedBox_dabnx_40 _speedBox_dabnx_5"};function dn(e,t){return void 0===t||0===t?`${e}: unknown`:(t!==Math.round(t)&&(t=Math.round(10*t)/10),`${e}: ${t} chars/sec`)}const un="input",mn="output";const fn=50;function pn({inputCharsPerSec:e,outputCharsPerSec:n}){const[r,a]=t.useState(0),[o]=t.useState(function(e,t){return{startTime:Date.now(),inputDuration:void 0===e?0:dn(un,e).length/e*1e3,outputDuration:void 0===t?0:dn(mn,t).length/t*1e3}}(e,n)),i=t.useMemo(()=>dn("input",e),[e]),s=t.useMemo(()=>dn("output",n),[n]),{inputProgress:l,outputProgress:c}=function(e){const{startTime:t,inputDuration:n,outputDuration:r}=e,a=n+r,o=(Date.now()-t)%a;let i=0,s=0;return o<n?i=o/n:(i=1,s=(o-n)/r),{inputProgress:i,outputProgress:s}}(o);return t.useEffect(()=>{const e=setTimeout(()=>{a(r+1)},fn);return()=>clearInterval(e)},[r]),d.jsxs("div",{className:cn.container,children:[d.jsxs("div",{className:cn.inputSpeedBox,children:[d.jsx("div",{className:cn.progressBar,style:{width:100*l+"%"}}),d.jsx("div",{className:cn.overTextBar,style:{width:100*(1-l)+"%"}}),i]}),d.jsxs("div",{className:cn.outputSpeedBox,children:[d.jsx("div",{className:cn.progressBar,style:{width:100*c+"%"}}),d.jsx("div",{className:cn.overTextBar,style:{width:100*(1-c)+"%"}}),s]})]})}const hn={problemList:"_problemList_1a0tc_4",icon:"_icon_1a0tc_20"},_n="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M17,17H7V7H17M21,11V9H19V7C19,5.89%2018.1,5%2017,5H15V3H13V5H11V3H9V5H7C5.89,5%205,5.89%205,7V9H3V11H5V13H3V15H5V17A2,2%200%200,0%207,19H9V21H11V19H13V21H15V19H17A2,2%200%200,0%2019,17V15H21V13H19V11M13,13H11V11H13M15,9H9V15H15V9Z'%20/%3e%3c/svg%3e",Mn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M12,3C7.58,3%204,4.79%204,7C4,9.21%207.58,11%2012,11C16.42,11%2020,9.21%2020,7C20,4.79%2016.42,3%2012,3M4,9V12C4,14.21%207.58,16%2012,16C16.42,16%2020,14.21%2020,12V9C20,11.21%2016.42,13%2012,13C7.58,13%204,11.21%204,9M4,14V17C4,19.21%207.58,21%2012,21C16.42,21%2020,19.21%2020,17V14C20,16.21%2016.42,18%2012,18C7.58,18%204,16.21%204,14Z'%20/%3e%3c/svg%3e",gn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M13%2011H11V5H13M13%2015H11V13H13M20%202H4C2.9%202%202%202.9%202%204V22L6%2018H20C21.1%2018%2022%2017.1%2022%2016V4C22%202.9%2021.1%202%2020%202Z'%20/%3e%3c/svg%3e",bn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M12%2016C13.66%2016%2015%2014.66%2015%2013C15%2011.88%2014.39%2010.9%2013.5%2010.39L3.79%204.77L9.32%2014.35C9.82%2015.33%2010.83%2016%2012%2016M12%203C10.19%203%208.5%203.5%207.03%204.32L9.13%205.53C10%205.19%2011%205%2012%205C16.42%205%2020%208.58%2020%2013C20%2015.21%2019.11%2017.21%2017.66%2018.65H17.65C17.26%2019.04%2017.26%2019.67%2017.65%2020.06C18.04%2020.45%2018.68%2020.45%2019.07%2020.07C20.88%2018.26%2022%2015.76%2022%2013C22%207.5%2017.5%203%2012%203M2%2013C2%2015.76%203.12%2018.26%204.93%2020.07C5.32%2020.45%205.95%2020.45%206.34%2020.06C6.73%2019.67%206.73%2019.04%206.34%2018.65C4.89%2017.2%204%2015.21%204%2013C4%2012%204.19%2011%204.54%2010.1L3.33%208C2.5%209.5%202%2011.18%202%2013Z'%20/%3e%3c/svg%3e",Cn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M8,3A2,2%200%200,0%206,5V9A2,2%200%200,1%204,11H3V13H4A2,2%200%200,1%206,15V19A2,2%200%200,0%208,21H10V19H8V14A2,2%200%200,0%206,12A2,2%200%200,0%208,10V5H10V3M16,3A2,2%200%200,1%2018,5V9A2,2%200%200,0%2020,11H21V13H20A2,2%200%200,0%2018,15V19A2,2%200%200,1%2016,21H14V19H16V14A2,2%200%200,1%2018,12A2,2%200%200,1%2016,10V5H14V3H16Z'%20/%3e%3c/svg%3e",Ln="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M9.23,17.59V23.12H6.88V6.72C6.88,5.27%207.31,4.13%208.16,3.28C9,2.43%2010.17,2%2011.61,2C13,2%2014.07,2.34%2014.87,3C15.66,3.68%2016.05,4.62%2016.05,5.81C16.05,6.63%2015.79,7.4%2015.27,8.11C14.75,8.82%2014.08,9.31%2013.25,9.58V9.62C14.5,9.82%2015.47,10.27%2016.13,11C16.79,11.71%2017.12,12.62%2017.12,13.74C17.12,15.06%2016.66,16.14%2015.75,16.97C14.83,17.8%2013.63,18.21%2012.13,18.21C11.07,18.21%2010.1,18%209.23,17.59M10.72,10.75V8.83C11.59,8.72%2012.3,8.4%2012.87,7.86C13.43,7.31%2013.71,6.7%2013.71,6C13.71,4.62%2013,3.92%2011.6,3.92C10.84,3.92%2010.25,4.16%209.84,4.65C9.43,5.14%209.23,5.82%209.23,6.71V15.5C10.14,16.03%2011.03,16.29%2011.89,16.29C12.73,16.29%2013.39,16.07%2013.86,15.64C14.33,15.2%2014.56,14.58%2014.56,13.79C14.56,12%2013.28,11%2010.72,10.75Z'%20/%3e%3c/svg%3e";function vn(e){switch(e){case ue.INSUFFICIENT_VRAM:return d.jsx("img",{className:hn.icon,src:_n,alt:"Insufficient VRAM"});case ue.INSUFFICIENT_STORAGE:return d.jsx("img",{className:hn.icon,src:Mn,alt:"Insufficient Storage"});case ue.BAD_LOAD_SUCCESS_HISTORY:return d.jsx("img",{className:hn.icon,src:gn,alt:"Bad Load Success History"});case ue.BAD_PERFORMANCE_HISTORY:return d.jsx("img",{className:hn.icon,src:bn,alt:"Bad Performance History"});case ue.WEBGPU_NOT_AVAILABLE:return d.jsx("img",{className:hn.icon,src:_n,alt:"WebGPU Not Available"});case ue.DEVELOPER_MODE:return d.jsx("img",{className:hn.icon,src:Cn,alt:"Developer Mode"});case ue.BETA:return d.jsx("img",{className:hn.icon,src:Ln,alt:"Beta"})}}function qn({problems:e}){if(!e)return null;e.length;const t=e.map((e,t)=>d.jsxs("li",{children:[vn(e.type),e.description]},t));return d.jsx("ul",{className:hn.problemList,children:t})}function yn({modelId:e,appBehaviorSummary:t,problems:n,inputCharsPerSec:r,outputCharsPerSec:a}){const o=r>0||a>0?d.jsx("div",{className:ln.speedContainer,children:d.jsx(pn,{inputCharsPerSec:r,outputCharsPerSec:a})}):null,i=e===De?"Auto Select Model":e;return d.jsxs("div",{className:ln.container,children:[d.jsx("div",{className:ln.modelIdText,children:i}),d.jsx("p",{className:ln.appBehaviorSummary,children:t}),d.jsx(qn,{problems:n}),o]})}function In({setting:e,onChange:n,onValidateSetting:r,disabled:a}){const[o,i]=t.useState(e.value),[s,l]=t.useState(null),[c,u]=t.useState([]);t.useEffect(()=>{Ve(e.models,u)},[e.models]);const m=s?d.jsx("div",{className:Ut.validationMessage,children:s}):null,f=e.models.length,p=a?Ut.labelDisabled:Ut.label,h=function(e){return e.map(e=>d.jsx(yn,{modelId:e.id,appBehaviorSummary:e.appBehaviorSummary,problems:e.problems,inputCharsPerSec:e.inputCharsPerSec,outputCharsPerSec:e.outputCharsPerSec},e.id))}(c);let _=c.findIndex(t=>t.id===e.value);-1===_&&(_=0);const M=0===f?d.jsx("span",{children:"LLM is not used by app."}):d.jsx(Ht,{optionNames:c.map(e=>e.displayName),iconChars:c.map(e=>e.iconChar),selectedOptionNo:_,onChange:t=>function(t){const a={...e,value:t},s=Zt(a,o,l,r);s&&i(a.value),n(a,s)}(c[t].id),disabled:a,popoverContent:h,popoverPreferredDirection:kt.BELOW});return d.jsxs("div",{className:Ut.container,children:[d.jsx("span",{className:p,children:e.label}),M,m]})}function wn(e,t,n,r,a,o,i){const s=[...a];a[t]!==r&&(s[t]=r,o(s));const l=!s.includes(!1),c={...e};c.settings[t]=n,i(c,l)}function Bn(e,t,n,r,a){const o=function(e){const t=[],n=e.headings??[];e.settings.forEach(e=>{let r=n.find(t=>t.precedeSettingId===e.id);r&&t.push({type:A,...r}),t.push(e)});const r=n.find(e=>null===e.precedeSettingId);return r&&t.push({type:A,...r}),t}(e);if(!o.length)return d.jsx("p",{children:"No settings are available."});const i=function(e){if(!e.disablementRules)return[];const t=[];return e.disablementRules.forEach(n=>{const r=e.settings.find(e=>e.id===n.criteriaSettingId);if(!r)throw new Error(`Disablement rule for setting ${n.targetSettingId} references non-existent criteria setting ${n.criteriaSettingId}`);r.value===n.criteriaValue&&t.push(n.targetSettingId)}),t}(e);return o.map((o,s)=>{const l=e.settings.findIndex(e=>e.id===o.id);switch(o.type){case ee.BOOLEAN_TOGGLE:const c=o;return d.jsx(Xt,{setting:c,onValidateSetting:a,onChange:(a,o)=>wn(e,l,a,o,t,n,r),disabled:i.includes(c.id)},o.id);case ee.NUMERIC:const u=o;return d.jsx(tn,{setting:u,onValidateSetting:a,onChange:(a,o)=>wn(e,l,a,o,t,n,r),disabled:i.includes(u.id)},o.id);case ee.TEXT:const m=o;return d.jsx(nn,{setting:m,onValidateSetting:a,onChange:(a,o)=>wn(e,l,a,o,t,n,r),disabled:i.includes(m.id)},o.id);case ee.SUPPORTED_MODEL:const f=o;return d.jsx(In,{setting:f,onValidateSetting:a,onChange:(a,o)=>wn(e,l,a,o,t,n,r),disabled:i.includes(f.id)},o.id);case A:return d.jsx(sn,{heading:o},`heading@${s}`);default:throw Error("Unexpected")}})}function Sn({category:e,onValidateSetting:n,onChange:r,isOpen:a}){const[o,i]=t.useState(Array(e.settings.length).fill(!0)),s=Bn(e,o,i,r,n);return a?d.jsxs("div",{className:Ft.container,children:[d.jsx("p",{children:e.description}),d.jsx("div",{className:Ft.setterList,children:s})]}):null}const xn={container:"_container_1ldt5_1"};function Rn(e){const{children:t}=e;return d.jsx("div",{className:xn.container,children:t})}const En={dialogButton:"_dialogButton_1e5oo_6 _disableSelect_mpqe1_1",dialogButtonText:"_dialogButtonText_1e5oo_28",dialogButtonDisabled:"_dialogButtonDisabled_1e5oo_34 _dialogButton_1e5oo_6 _disableSelect_mpqe1_1",dialogButtonTextDisabled:"_dialogButtonTextDisabled_1e5oo_44 _dialogButtonText_1e5oo_28",dialogButtonPrimary:"_dialogButtonPrimary_1e5oo_49 _dialogButton_1e5oo_6 _disableSelect_mpqe1_1"};function Tn(e){const{text:t,onClick:n,disabled:r,isPrimary:a}=e,o=r?En.dialogButtonDisabled:a?En.dialogButtonPrimary:En.dialogButton,i=r?En.dialogButtonTextDisabled:En.dialogButtonText;return d.jsx("button",{className:o,onClick:n,disabled:r,children:d.jsx("span",{className:i,children:t})})}async function jn(e,t,n){await Tt(e,n),t(e[0].settings)}function Nn(e){const{isOpen:t,onCancel:n,onConfirm:r}=e;return d.jsxs(k,{isOpen:t,title:"LLM Changed",onCancel:n,children:[d.jsx("p",{children:"Would you like to reload the app to use the new LLM that you chose?"}),d.jsxs(Rn,{children:[d.jsx(Tn,{text:"Not Now",onClick:n}),d.jsx(Tn,{text:"Refresh Page",onClick:r,isPrimary:!0})]})]})}function kn({isOpen:e,defaultAppSettings:n,onClose:r,onLoadAppSettings:a,onSaveAppSettings:o,onValidateSetting:i}){const s=t.useRef(n),[l,c]=t.useState([]),[u,m]=t.useState(0),[f,p]=t.useState(Array(l.length).fill(!0)),[h,_]=t.useState(!1),[M,g]=t.useState(null),b=t.useMemo(()=>l.map(e=>e.name),[l]);if(t.useEffect(()=>{e&&async function(e,t){return await Et(e,t)}(s.current,a).then(e=>{c(e),m(xt(e));const t=e[0].settings.find(e=>e.id===Qe);g(t?.value?String(t.value):null)})},[e,a]),!e||!l.length)return null;const C=f.includes(!1);return d.jsxs(d.Fragment,{children:[d.jsxs(k,{title:"Device Settings",isOpen:e,onCancel:()=>r(l[0].settings),children:[d.jsx(Gt,{selectedCategoryNo:u,categoryNames:b,onChange:e=>{m(e),St(l[e].id)},disabled:C}),l.map((e,t)=>d.jsx(Sn,{category:e,isOpen:u===t,onValidateSetting:i,onChange:(e,n)=>function(e,t,n){const r=[...f];f[e]!==n&&(r[e]=n,p(r));const a=[...l];a[e]=t,c(a)}(t,e,n)},e.name)),d.jsxs(Rn,{children:[d.jsx(Tn,{text:"Cancel",onClick:r}),d.jsx(Tn,{text:"Save and Exit",onClick:function(){const e=l[0].settings.find(e=>e.id===Qe),t=e?.value?String(e.value):null;M!==t?_(!0):jn(l,r,o)},isPrimary:!0,disabled:C})]})]}),d.jsx(Nn,{isOpen:h,onConfirm:function(){jn(l,()=>{r(l[0].settings),window.location.reload()},o)},onCancel:function(){_(!1),jn(l,r,o)}})]})}const An="_container_hyytp_4 _disableSelect_mpqe1_1",Pn="_containerError_10gzw_26 _container_10gzw_3",Dn="_containerInfo_10gzw_31 _container_10gzw_3",On="_containerImportant_10gzw_36 _container_10gzw_3",Vn="_containerAppear_10gzw_51",$n="_containerDisappear_10gzw_56",Qn="_dismissIcon_10gzw_61";function Hn(e){const{onDismiss:t,toast:n,toastState:r}=e,{message:a,type:o}=n,i=Ze(o),s=`${function(e){switch(e){case Ue.ERROR:return Pn;case Ue.IMPORTANT:return On;default:return Dn}}(o)} ${function(e){switch(e){case ze.APPEARING:return Vn;case ze.DISAPPEARING:return $n;default:return""}}(r)}`,l=i?d.jsx("div",{className:Qn,onClick:t,children:"✖"}):null;return d.jsxs("div",{className:s,onClick:t,children:[d.jsx("p",{children:a}),l]})}let Gn=0;function Fn(){const e=t.useRef([]),[n,r]=t.useState(0),a=t=>function(e,t){const n=e.current,r=Date.now(),a=++Gn,o=Ze(t.type),i={...t,state:ze.APPEARING,lastStateTime:r,id:a,requiresDismissing:o};e.current=[...n,i]}(e,t);!function(e){const t=e.current,n=Date.now();let r=!1;const a=t.map(e=>{const{state:t,lastStateTime:a,requiresDismissing:o}=e,i=n-a;switch(t){case ze.APPEARING:return i<1e3?e:(r=!0,{...e,state:ze.VISIBLE,lastStateTime:n});case ze.VISIBLE:return o||i<5e3?e:(r=!0,{...e,state:ze.DISAPPEARING,lastStateTime:n});case ze.DISAPPEARING:return i<1e3?e:(r=!0,{...e,state:ze.GONE,lastStateTime:n});default:return e}});r&&(e.current=a.filter(e=>e.state!==ze.GONE))}(e),t.useEffect(()=>{var e;return e=a,Ye.subscribe(e),()=>function(e){Ye.unsubscribe(e)}(a)},[]),t.useEffect(()=>{setTimeout(()=>r(n+1),200)},[n,r]);const o=e.current.map(t=>d.jsx(Hn,{toast:t,toastState:t.state,onDismiss:()=>function(e,t){const n=t.current,r=Date.now();t.current=n.map(t=>t.id!==e?t:t.state===ze.DISAPPEARING?{...t,requiresDismissing:!1}:{...t,requiresDismissing:!1,lastStateTime:r,state:ze.DISAPPEARING})}(t.id,e)},t.id));return d.jsx("div",{className:An,children:o})}async function Un(e,t,n){try{!function(e){wt=e}(n);const t=await async function(){const e=await J(vt);return e||ae(It().settings)}();await bt(t),function(e){e!==mt&&(mt=e,_t(`*** ${e} session ***`))}(e)}catch(i){console.error("Error applying logging settings:",i)}let r=null;const a=function(e){const t=window.location.hostname.toLowerCase();return e.some(e=>t===e.toLowerCase()||t.endsWith(`.${e.toLowerCase()}`))}(t),o=document.querySelector('link[rel~="icon"][sizes="192x192"]')||document.querySelector('link[rel~="icon"]');return r=o?o.href:null,{isDecentBarEnabled:a,favIconUrl:r}}const zn=["decentapps.net","127.0.0.1","localhost"];function Yn(e){if(e.url.startsWith("http")){const t=e.url.startsWith(R())?"_self":"_blank";window.open(e.url,t)}else console.error('Link URL does not start with "http"--navigation canceled.',e.url)}const Wn="_continueText_rt9ep_4",Jn="_modelIdText_rt9ep_8",Zn="_problemPanel_rt9ep_16";e.APP_CATEGORY_ID=$e,e.DecentBar=function({appName:e=Ie(),appLinks:n,contributorText:r,onClickLink:a=Yn,enabledDomains:o=zn,homeUrl:i=R(),classNameOverrides:s={},defaultAppSettings:l,onLoadAppSettings:c,onSaveAppSettings:C,onValidateSetting:L}){const v=t.useRef(l||function(e){return{description:`These settings apply solely to ${e}, while other settings apply to all apps.`,settings:[]}}(e)),[q,I]=t.useState(null),[w,B]=t.useState(null);if(t.useEffect(()=>{Un(e,o,B).then(e=>{e.isDecentBarEnabled?e.favIconUrl?I(e.favIconUrl):console.error("DecentBar did not render because no favicon image was set."):console.log("DecentBar did not render because the current domain is not in the enabled domains list.")})},[]),!q)return null;const S=function(e,t){if(!e.length)return d.jsx(d.Fragment,{children:" "});const n=e.map((e,n)=>d.jsx(y,{text:e.description,onClick:()=>{t(e)}},n));return d.jsxs(d.Fragment,{children:["Links:",d.jsx("br",{}),n]})}(n||[],a),x=`${u} ${s?.container??""}`,E=`${m} ${s?.decentFacet??""}`,T=`${g} ${s?.favIcon??""}`,j=`${f} ${s?.appFacet??""}`,N=`${p} ${s?.appName??""}`,k=`${h} ${s?.appButtonArea??""}`,A=`${_} ${s?.appFacetSeparator??""}`,P=`${M} ${s?.contributorFacet??""}`,D=`${b} ${s?.settingsIcon??""}`;return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:x,children:[d.jsx("div",{className:E,children:d.jsx("a",{href:i,children:d.jsx("img",{src:q,className:T,draggable:"false"})})}),d.jsxs("div",{className:j,children:[d.jsx("div",{className:N,children:e}),d.jsx("div",{className:k,children:S})]}),d.jsx("div",{className:A}),d.jsxs("div",{className:P,children:[r,d.jsx("img",{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M12,15.5A3.5,3.5%200%200,1%208.5,12A3.5,3.5%200%200,1%2012,8.5A3.5,3.5%200%200,1%2015.5,12A3.5,3.5%200%200,1%2012,15.5M19.43,12.97C19.47,12.65%2019.5,12.33%2019.5,12C19.5,11.67%2019.47,11.34%2019.43,11L21.54,9.37C21.73,9.22%2021.78,8.95%2021.66,8.73L19.66,5.27C19.54,5.05%2019.27,4.96%2019.05,5.05L16.56,6.05C16.04,5.66%2015.5,5.32%2014.87,5.07L14.5,2.42C14.46,2.18%2014.25,2%2014,2H10C9.75,2%209.54,2.18%209.5,2.42L9.13,5.07C8.5,5.32%207.96,5.66%207.44,6.05L4.95,5.05C4.73,4.96%204.46,5.05%204.34,5.27L2.34,8.73C2.21,8.95%202.27,9.22%202.46,9.37L4.57,11C4.53,11.34%204.5,11.67%204.5,12C4.5,12.33%204.53,12.65%204.57,12.97L2.46,14.63C2.27,14.78%202.21,15.05%202.34,15.27L4.34,18.73C4.46,18.95%204.73,19.03%204.95,18.95L7.44,17.94C7.96,18.34%208.5,18.68%209.13,18.93L9.5,21.58C9.54,21.82%209.75,22%2010,22H14C14.25,22%2014.46,21.82%2014.5,21.58L14.87,18.93C15.5,18.67%2016.04,18.34%2016.56,17.94L19.05,18.95C19.27,19.03%2019.54,18.95%2019.66,18.73L21.66,15.27C21.78,15.05%2021.73,14.78%2021.54,14.63L19.43,12.97Z'%20/%3e%3c/svg%3e",className:D,alt:"Device Settings",onClick:()=>B(kn.name)})]})]}),d.jsx(kn,{isOpen:w===kn.name,defaultAppSettings:v.current,onClose:()=>B(null),onLoadAppSettings:c,onSaveAppSettings:C,onValidateSetting:L}),d.jsx(Fn,{})]})},e.LLM_CATEGORY_ID=be,e.LOGGING_CATEGORY_ID=vt,e.ModelDeviceProblemType=ue,e.ModelDeviceProblemsDialog=function({isOpen:e,problems:n,onConfirm:r,onCancel:a,modelId:o,supportedModels:i}){const[s,l]=t.useState(null);if(t.useEffect(()=>{(async function(e){e||(e=(await Be()).supportedModels);return Math.max(0,e.length-1)})(i).then(l)},[]),!e||!n||null===s)return null;n.length;const c=1===n.length&&n[0].type===ue.DEVELOPER_MODE;n.length>1&&(n=n.filter(e=>e.type!==ue.DEVELOPER_MODE));const u=n.some(e=>e.isBlocking),m=c?d.jsxs("p",{children:["Development environment detected. Paused loading ",d.jsx("span",{className:Jn,children:o})," until you confirm."]}):1===n.length?d.jsxs("p",{children:["The following problem was found for loading ",d.jsx("span",{className:Jn,children:o}),":"]}):d.jsxs("p",{children:["The following problems were found for loading ",d.jsx("span",{className:Jn,children:o}),":"]}),f=function(e){return 0===e?"":1===e?" Another model supported by this app is available.":" Other models supported by this app are available."}(s),p=u?`This model can't be loaded.${f}`:`You can continue loading the model if you want.${f}`,h=function(e,t,n,r){const a=[];return t>0&&a.push(d.jsx(Tn,{text:"Other Models",onClick:()=>{n(),Rt($e)},disabled:!t},"otherModels")),a.push(d.jsx(Tn,{text:"Cancel",onClick:n,isPrimary:e},"cancel")),e||a.push(d.jsx(Tn,{text:"Load Model",onClick:r,isPrimary:!0},"loadModel")),a}(u,s,a,r);return d.jsxs(k,{isOpen:e,title:u?"Failed to Load Model":"Continue Loading Model?",onCancel:a,children:[m,d.jsx("div",{className:Zn,children:d.jsx(qn,{problems:n})}),d.jsx("p",{className:Wn,children:p}),d.jsx(Rn,{children:h})]})},e.SettingType=ee,e.assert=B,e.assertNonNullable=w,e.assertTruthy=function(e,t="Condition is unexpectedly falsy."){if(!e)throw new Error(t)},e.botch=S,e.defaultOnClickLink=Yn,e.errorToast=Je,e.findBestModel=async function(){const{supportedModels:e}=await Be();if(!e.length)throw Error("No supported LLM models for this app.");const t=await Fe();let n=De;if(t){const e=t[Qe];"string"==typeof e&&(n=e)}if(n!==De&&e.some(e=>e.id===n))return n;let r=-1,a=-1;for(let o=0;o<e.length;++o){const t=e[o],n=await Pe(t.id,!!t.beta);n>r&&(r=n,a=o)}return e[a].id},e.getAppId=function(){if(!ye)throw new Error("App metadata not initialized yet.");return ye.id},e.getAppMetaData=Be,e.getAppName=Ie,e.getAppSettings=Fe,e.importantToast=function(e){Ye.sendToast(e,Ue.IMPORTANT)},e.infoToast=We,e.initAppMetaData=we,e.log=_t,e.openSettings=function(e){Rt(e)},e.predictModelDeviceProblems=Ae,e.scoreModel=Pe,e.updateModelDeviceLoadHistory=async function(e,t,n=0){await Re(e),de(t?1:0,Se.history.loadSuccessRate),t&&(de(n,Se.history.loadTime),await async function(e){const t=ae((await qe()).settings);if(!t[Le])return;t[Ce]>=e||(t[Ce]=Math.ceil(e),Z(be,t))}(Se.requiredMemoryGb)),await Ee()},e.updateModelDevicePerformanceHistory=async function(e,t,n,r,a,o){const{inputCharsPerSec:i,outputCharsPerSec:s}=function(e,t,n,r,a){const o=t-e,i=n-t;return{inputCharsPerSec:0===o?0:r/o*1e3,outputCharsPerSec:0===i?0:a/i*1e3}}(t,n,r,a,o);0===i&&0===s||(await Re(e),i&&de(i,Se.history.inputCharsPerSec),s&&de(s,Se.history.outputCharsPerSec),await Ee())},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=decent-portal.umd.cjs.map
